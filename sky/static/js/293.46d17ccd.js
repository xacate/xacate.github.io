"use strict";(self.webpackChunkskyweb=self.webpackChunkskyweb||[]).push([[293],{293:function(e,t,l){l.r(t),l.d(t,{default:function(){return U}});var a=l(5918),r=l(6544),o=l(7361),s=l(349),n=l(3297),i=l(3863),c=l(7652),u=l(3697),d=l(2538),f=l(5751),v=l(8165),m=l(879);const y={class:"h-1 scroll position-re tk-p-20 tk-fs-13"},p={class:"tk-fs-18"},A={class:"tk-fs-12"},g={class:"tk-fs-12"},k={class:"tk-fs-12"},h={class:"flex-row flex-just-end tk-m-t-16"},V={class:"tk-m-t-60"},_={class:"tk-fs-18"},w={class:"tk-fs-14 color-detail-color"},E={class:"tk-fs-14 color-detail-color"},N={class:"flex-1 s-line-1 tk-p-r-10"},b=["src"],$={class:"tk-m-t-14"},x={class:"color-detail-color tk-fs-12"},S={class:"tk-w-200 tk-h-200"},C={class:"tk-fs-12"},B={class:"color-detail-color"},D={class:"flex-row flex-just-end tk-m-t-16"};var U=(0,a.defineComponent)({__name:"secret",setup(e){var t=l(7583);const{useMobile:U}=(0,u.storeToRefs)((0,i.pp)()),{userInfo:z}=(0,u.storeToRefs)((0,c.P)()),R=(0,a.ref)(0),I=e=>{if(!(e.length>3))return(0,n.$t)("$vuetify.login_email_code")},j=e=>{if(!(e.length>5))return(0,n.$t)("$vuetify.login_password_rule_title")},W=e=>{if(!(e.length>6))return(0,n.$t)("$vuetify.login_account_rule_title")},Y=(0,a.ref)(z.value.email),Q=(0,a.ref)(""),K=(0,a.ref)(""),H=(0,a.ref)(),M=(0,a.ref)(),X=(0,a.ref)();let q=0;const J=async e=>{if(H.value.validate()){try{await f.clientApi.userApi.sendCodeByEmail(Y.value),(0,v.rW)((0,n.$t)("$vuetify.login_send_email_code"),"success"),(0,s.L8)((e=>((0==q||e-q>60)&&(q=e),R.value=60-(e-q),e-q>60)))}catch(e){(0,v.rW)(e.message)}e()}else e()},P=(0,a.ref)(),F=(0,a.ref)(""),G=(0,a.ref)(""),T=(0,a.ref)(""),L=(0,a.ref)(!1),Z=async()=>{try{const{qrCodeText:e,secretKey:l}=await f.clientApi.userApi.getGoogleSecretKey();G.value=e,F.value=l,(async()=>{await(0,s.cP)((async()=>!!P.value)),t.toCanvas(P.value,G.value??"--",{margin:1,width:180,height:180},(function(e){e&&(0,v.rW)(e)}))})()}catch(e){(0,v.rW)(e.message)}};(0,a.onMounted)((()=>{d.UserInfoInstance.getUserValidateSetWeb().then((e=>{e&&(L.value="no"!==d.UserInfoInstance.authInfo.google)})),Z()}));const O=async e=>{if(H.value.validate()&&M.value.validate()&&X.value.validate()){try{await f.clientApi.userApi.resetPasswordByEmail({email:Y.value,code:Q.value.trim(),password:K.value,repassword:K.value}),Q.value="",K.value="",(0,v.Eg)()}catch(e){(0,v.rW)(e.message)}e()}else e()},ee=()=>{(0,m.hR)(F.value)},te=async e=>{try{await f.clientApi.userApi.addGoogleSecretKey({secretKey:F.value,code:T.value}),(0,v.Eg)()}catch(e){(0,v.rW)(e.message)}e()};return(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",y,[(0,a.createElementVNode)("div",null,[(0,a.createElementVNode)("div",p,(0,a.toDisplayString)((0,a.unref)(n.$t)("$vuetify.login_forget_title")),1),t[4]||(t[4]=(0,a.createElementVNode)("div",{class:"tk-m-v-12",style:{"border-top-style":"dashed","border-top-width":"1px","border-top-color":"#aaaaaa55"}},null,-1)),(0,a.createElementVNode)("div",A,[(0,a.createVNode)(o.A,{style:(0,a.normalizeStyle)({width:(0,a.unref)(U)?"100%":"50%"}),ref_key:"emailRef",ref:H,modelValue:Y.value,"onUpdate:modelValue":t[0]||(t[0]=e=>Y.value=e),placeholder:(0,a.unref)(n.$t)("$vuetify.login_account_rule_title"),rules:W},null,8,["style","modelValue","placeholder"])]),(0,a.createElementVNode)("div",g,[(0,a.createVNode)(o.A,{style:(0,a.normalizeStyle)({width:(0,a.unref)(U)?"100%":"50%"}),ref_key:"emailCodeRef",ref:M,modelValue:Q.value,"onUpdate:modelValue":t[1]||(t[1]=e=>Q.value=e),placeholder:(0,a.unref)(n.$t)("$vuetify.login_email_code"),rules:I},{btn:(0,a.withCtx)((()=>[(0,a.createVNode)(r.A,{class:"tk-m-l-5 tk-fs-12",onHandler:J,title:R.value>0?(0,a.unref)(n.$t)("$vuetify.left_sec_second",{code:R.value}):(0,a.unref)(n.$t)("$vuetify.login_get_email_code")},null,8,["title"])])),_:1},8,["style","modelValue","placeholder"])]),(0,a.createElementVNode)("div",k,[(0,a.createVNode)(o.A,{style:(0,a.normalizeStyle)({width:(0,a.unref)(U)?"100%":"50%"}),ref_key:"passwordRef",ref:X,type:"password",rules:j,modelValue:K.value,"onUpdate:modelValue":t[2]||(t[2]=e=>K.value=e),placeholder:(0,a.unref)(n.$t)("$vuetify.login_password_rule_title")},null,8,["style","modelValue","placeholder"])]),(0,a.createElementVNode)("div",h,[(0,a.createVNode)(r.A,{onHandler:O,color:"#ffffff",title:(0,a.unref)(n.$t)("$vuetify.confirmEdit.ok"),ground:"rgb(50, 112, 232)",class:"pointer tk-p-h-20 color-blue tk-p-v-5 tk-br-5"},null,8,["title"])])]),t[6]||(t[6]=(0,a.createElementVNode)("div",{class:"tk-m-t-20 tk-h-10 position-ab",style:{left:"0",right:"0","background-color":"#00000055"}},null,-1)),(0,a.createElementVNode)("div",V,[(0,a.createElementVNode)("div",_,(0,a.toDisplayString)((0,a.unref)(n.$t)("$vuetify.settings_sub_v")),1),(0,a.createElementVNode)("div",w,(0,a.toDisplayString)((0,a.unref)(n.$t)("$vuetify.settings_open_sub_v")),1),t[5]||(t[5]=(0,a.createElementVNode)("div",{class:"tk-m-v-12",style:{"border-top-style":"dashed","border-top-width":"1px","border-top-color":"#aaaaaa55"}},null,-1)),(0,a.createElementVNode)("div",E,(0,a.toDisplayString)((0,a.unref)(n.$t)("$vuetify.settings_copy_user_t")),1),(0,a.createElementVNode)("div",{class:"flex-row tk-m-t-8 tk-br-6 flex-align-center tk-p-h-10 tk-h-40 flex-just-between color-back-ae",style:(0,a.normalizeStyle)({width:(0,a.unref)(U)?"100%":"60%"})},[(0,a.createElementVNode)("span",N,(0,a.toDisplayString)(F.value),1),(0,a.createElementVNode)("img",{onClick:ee,class:"tk-h-20 pointer",src:l(1985),alt:""},null,8,b)],4),(0,a.createElementVNode)("div",$,[(0,a.createElementVNode)("span",x,(0,a.toDisplayString)((0,a.unref)(n.$t)("$vuetify.settings_t_t")),1),(0,a.createElementVNode)("div",S,[(0,a.createElementVNode)("canvas",{ref_key:"canvasRef",ref:P},null,512)])]),(0,a.createElementVNode)("div",C,[(0,a.createElementVNode)("span",B,(0,a.toDisplayString)((0,a.unref)(n.$t)("$vuetify.wallet_google_code")),1),(0,a.createElementVNode)("div",{class:"color-back-ae tk-m-t-6 tk-br-6 flex-just-between tk-p-h-18 tk-h-40 flex-row flex-align-center",style:(0,a.normalizeStyle)({width:(0,a.unref)(U)?"100%":"50%"})},[(0,a.withDirectives)((0,a.createElementVNode)("input",{class:"tk-fs-15",type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>T.value=e)},null,512),[[a.vModelText,T.value]])],4)]),(0,a.createElementVNode)("div",D,[(0,a.createVNode)(r.A,{onHandler:te,color:"#ffffff",ground:"rgb(50, 112, 232)",title:(0,a.unref)(n.$t)("$vuetify.wallet_save_type")},null,8,["title"])])])]))}})},1985:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAC/SURBVHgB7ZbhCcIwEIVfQgboCBmhIziCGziDE6gbuEFX0AmKE5gNmg0c4bxgBZFcW8i1P0o/eAQuJC8h4e4AASLyrJbK6NI+GDBpSIenhYyHDrXFAqzHxPHDVDyeWHUfexhjzlDEsRrW/icWoYz9M5iF7XdtJis0qaBMzuSbXu7Q4eYywVQRd5y/rqnioCwjBNYFQjV7sQ5QwvSnlYiYnjAD3/6Ym3AjCz0UyvBiXzhAhyjO0Ke/6qiMlgb6qzeBKxVSMJyrPwAAAABJRU5ErkJggg=="}}]);