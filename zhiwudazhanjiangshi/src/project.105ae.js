window.__require=function t(e,i,n){function o(a,c){if(!i[a]){if(!e[a]){var s=a.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+a+"'")}a=s}var u=i[a]={exports:{}};e[a][0].call(u.exports,function(t){return o(e[a][1][t]||t)},u,u.exports,t,e,i,n)}return i[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<n.length;a++)o(n[a]);return o}({AdLayer:[function(t,e,i){"use strict";cc._RF.push(e,"73543ezbFJOm7NG/VtG9woV","AdLayer");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r,a=t("../../script/framwork/BaseUI"),c=t("../../script/framwork/MsgHints"),s=t("../../script/utils/AudioMgr"),l=t("../../script/utils/Utils"),u=t("../../script/manager/Data"),p=cc._decorator,h=p.ccclass;p.property;(function(t){t[t.DOUBLE_ATT=0]="DOUBLE_ATT",t[t.DOUBLE_INCOME=1]="DOUBLE_INCOME",t[t.AUTO_COM=2]="AUTO_COM",t[t.DROP_PLANT=3]="DROP_PLANT"})(r||(r={})),i.EADLAYER=r;i.max_auto_com=10,i.max_auto_double_income=60,i.max_auto_double_att=6,i.max_drop_plant=60;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.update=function(t){var e=0,n=0;if(this.type==r.AUTO_COM?(e=u.default.user.auto_com_time,n=i.max_auto_com):this.type==r.DOUBLE_ATT?(e=u.default.user.double_att_time,n=i.max_auto_double_att):this.type==r.DOUBLE_INCOME?(e=u.default.user.double_income_time,n=i.max_auto_double_income):this.type==r.DROP_PLANT&&(e=u.default.user.drop_plant_time,n=i.max_drop_plant),e>l.default.getServerTime()){var o=e-l.default.getServerTime();this.SetProgressBar("New ProgressBar",o/1e3/60/n),this.SetText("lbl_time",l.default.getTimeStrByS(o/1e3))}else this.SetProgressBar("New ProgressBar",0),this.SetText("lbl_time","")},e.prototype.setType=function(t){this.type=t,this.GetGameObject("icon_fast").active=t==r.DROP_PLANT,this.GetGameObject("icon_auto_merge").active=t==r.AUTO_COM,this.GetGameObject("icon_income").active=t==r.DOUBLE_INCOME,this.GetGameObject("icon_angre").active=t==r.DOUBLE_ATT,this.type==r.AUTO_COM?this.SetText("lbl_effect","\u589e\u52a02\u5206\u949f\u81ea\u52a8\u5408\u6210\u65f6\u95f4"):this.type==r.DOUBLE_ATT?this.SetText("lbl_effect","\u589e\u52a01\u5206\u949f\u6301\u7eed\u65f6\u95f4"):this.type==r.DOUBLE_INCOME?this.SetText("lbl_effect","\u589e\u52a010\u5206\u949f\u53cc\u500d\u6536\u76ca\u65f6\u95f4"):this.type==r.DROP_PLANT&&this.SetText("lbl_effect","\u589e\u52a010\u5206\u949f\u690d\u7269\u5feb\u901f\u6389\u843d\u65f6\u95f4")},e.prototype.addvalue=function(t){if(void 0===t&&(t=0),this.type==r.AUTO_COM){if(u.default.user.auto_com_time-l.default.getServerTime()>60*(i.max_auto_com-2)*1e3)return void c.default.show("\u6700\u5927\u7d2f\u79ef\u65f6\u95f4"+i.max_auto_com+"\u5206\u949f")}else if(this.type==r.DOUBLE_ATT){if(u.default.user.double_att_time-l.default.getServerTime()>60*(i.max_auto_double_att-1)*1e3)return void c.default.show("\u6700\u5927\u7d2f\u79ef\u65f6\u95f4"+i.max_auto_double_att+"\u5206\u949f")}else if(this.type==r.DOUBLE_INCOME){if(u.default.user.double_income_time-l.default.getServerTime()>60*(i.max_auto_double_income-10)*1e3)return void c.default.show("\u6700\u5927\u7d2f\u79ef\u65f6\u95f4"+i.max_auto_double_income+"\u5206\u949f")}else if(this.type==r.DROP_PLANT&&u.default.user.drop_plant_time-l.default.getServerTime()>60*(i.max_drop_plant-10)*1e3)return void c.default.show("\u6700\u5927\u7d2f\u79ef\u65f6\u95f4"+i.max_drop_plant+"\u5206\u949f");if(t>0){if(t>u.default.user.gem)return void c.default.show("\u94bb\u77f3\u4e0d\u8db3");u.default.user.gem-=t}if(this.type==r.AUTO_COM){if(u.default.user.auto_com_time-l.default.getServerTime()>60*(i.max_auto_com-2)*1e3)return void c.default.show("\u6700\u5927\u7d2f\u79ef\u65f6\u95f4"+i.max_auto_com+"\u5206\u949f");u.default.user.auto_com_time<l.default.getServerTime()&&(u.default.user.auto_com_time=l.default.getServerTime()),u.default.user.auto_com_time+=12e4}else if(this.type==r.DOUBLE_ATT){if(u.default.user.double_att_time-l.default.getServerTime()>60*(i.max_auto_double_att-1)*1e3)return void c.default.show("\u6700\u5927\u7d2f\u79ef\u65f6\u95f4"+i.max_auto_double_att+"\u5206\u949f");u.default.user.double_att_time<l.default.getServerTime()&&(u.default.user.double_att_time=l.default.getServerTime()),u.default.user.double_att_time+=6e4}else if(this.type==r.DOUBLE_INCOME){if(u.default.user.double_income_time-l.default.getServerTime()>60*(i.max_auto_double_income-10)*1e3)return void c.default.show("\u6700\u5927\u7d2f\u79ef\u65f6\u95f4"+i.max_auto_double_income+"\u5206\u949f");u.default.user.double_income_time<l.default.getServerTime()&&(u.default.user.double_income_time=l.default.getServerTime()),u.default.user.double_income_time+=6e5}else if(this.type==r.DROP_PLANT){if(u.default.user.drop_plant_time-l.default.getServerTime()>60*(i.max_drop_plant-10)*1e3)return void c.default.show("\u6700\u5927\u7d2f\u79ef\u65f6\u95f4"+i.max_drop_plant+"\u5206\u949f");u.default.user.drop_plant_time<l.default.getServerTime()&&(u.default.user.drop_plant_time=l.default.getServerTime()),u.default.user.drop_plant_time+=6e5}u.default.save()},e.prototype.onBtnClicked=function(t,e){var i=this,n=t.target.name;switch(s.default.Instance().playSFX("click"),n){case"btn_close":this.closeUI();break;case"btn_ad":window.videoPlayEnd=function(){i.addvalue(0)},window.playVideoAd();break;case"btn_gem":var o=0;this.type==r.AUTO_COM?o=10:this.type==r.DOUBLE_ATT?o=10:this.type==r.DOUBLE_INCOME?o=10:this.type==r.DROP_PLANT&&(o=10),this.addvalue(o)}},e=o([h],e)}(a.default);i.default=d,cc._RF.pop()},{"../../script/framwork/BaseUI":"BaseUI","../../script/framwork/MsgHints":"MsgHints","../../script/manager/Data":"Data","../../script/utils/AudioMgr":"AudioMgr","../../script/utils/Utils":"Utils"}],AudioMgr:[function(t,e,i){"use strict";cc._RF.push(e,"c4310qOOsJLaZuNAeTaQNgO","AudioMgr");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=t("../manager/Singleton"),r=t("./Utils"),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgmVolume=1,e.sfxVolume=1,e.bgmAudioID=-1,e.audioId=-1,e.bgm_url="BGM1",e.lastplaysfxtime={},e.sfxcd={zb1:1500,zb2:1500,hit:300,merge_success:100,skill_freeze:300,skill_slow:300},e}return n(e,t),e.prototype.loadSounds=function(){var t=this,e=cc.sys.localStorage.getItem("bgmVolume"),i=cc.sys.localStorage.getItem("sfxVolume");this.bgmVolume=0==e?Number(e):1,this.sfxVolume=0==i?Number(i):1,cc.log(this.bgmVolume,this.sfxVolume),cc.loader.loadResDir("sounds",function(){t.playBGM("BGM1")})},e.prototype.getUrl=function(t){return cc.loader.getRes("sounds/"+t)},e.prototype.playBGM=function(t){this.bgm_url=t;var e=this.getUrl(t);this.bgmAudioID>=0&&cc.audioEngine.stop(this.bgmAudioID),this.bgmVolume>0&&(this.bgmAudioID=cc.audioEngine.play(e,!0,this.bgmVolume))},e.prototype.stopSFX=function(t){return cc.audioEngine.stop(t)},e.prototype.playSFX=function(t){this.lastplaysfxtime[t]||(this.lastplaysfxtime[t]=0);var e=this.sfxcd[t]||0;if(!(r.default.getServerTime()-this.lastplaysfxtime[t]<e)){this.lastplaysfxtime[t]=r.default.getServerTime();var i=this.getUrl(t);return this.sfxVolume>0?(this.audioId=cc.audioEngine.play(i,!1,this.sfxVolume),this.audioId):void 0}},e.prototype.pauseBGM=function(){this.bgmAudioID>=0&&cc.audioEngine.pause(this.bgmAudioID)},e.prototype.resumBGM=function(){this.bgmAudioID>=0&&cc.audioEngine.resume(this.bgmAudioID)},e.prototype.setBGMVolume=function(t,e){void 0===e&&(e=!1),(this.bgmVolume!=t||e)&&(cc.sys.localStorage.setItem("bgmVolume",t),this.bgmVolume=t,cc.audioEngine.setVolume(this.bgmAudioID,t)),this.bgmAudioID>=0?t>0?cc.audioEngine.resume(this.bgmAudioID):cc.audioEngine.pause(this.bgmAudioID):this.playBGM(this.bgm_url)},e.prototype.setSFXVolume=function(t,e){void 0===e&&(e=!1),(this.sfxVolume!=t||e)&&(cc.sys.localStorage.setItem("sfxVolume",t),this.sfxVolume=t)},e}(o.default);i.default=a,cc._RF.pop()},{"../manager/Singleton":"Singleton","./Utils":"Utils"}],BaseUI:[function(t,e,i){"use strict";cc._RF.push(e,"da6ddR8mzFCtI19mMwKxBRP","BaseUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function a(t){try{s(n.next(t))}catch(t){r(t)}}function c(t){try{s(n.throw(t))}catch(t){r(t)}}function s(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(a,c)}s((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var c=t("../event/GameEvent"),s=t("../utils/Utils"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.events=[],e._create_time=0,e.m_objects=new Map,e}var i;return n(e,t),i=e,e.prototype.onBtnClicked=function(t,e){switch(t.target.name){case"btn_close":this.closeUI()}},e.prototype.onLoad=function(){this.events=[],this.node.getComponent(cc.Button)&&s.default.addClickEvent(this.node,this.node,cc.js.getClassName(this),"onBtnClicked",this.node.getComponent(cc.Button).target),this._addClickEvent(this.node),this._create_time=s.default.getServerTime()},e.prototype._findInChildren=function(t,e){var i=t.getChildByName(e);if(i)return i;if(0==t.childrenCount)return null;for(var n=0;n<t.childrenCount;++n){var o=this._findInChildren(t.children[n],e);if(o)return o}return null},e.prototype.GetGameObject=function(t,e){if(void 0===e&&(e=!1),!cc.isValid(this.node))return null;if(!e){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t];if(t==this.node.name)return this.node}var i;return-1!=t.indexOf("/")?((i=cc.find(t,this.node))&&(this.m_objects[t]=i),i):((i=this._findInChildren(this.node,t))&&(this.m_objects[t]=i),i)},e.prototype.GetSkeleton=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(sp.Skeleton);var e=this.GetGameObject(t);return e?e.getComponent(sp.Skeleton):null},e.prototype.GetSprite=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(cc.Sprite);var e=this.GetGameObject(t);return e?e.getComponent(cc.Sprite):null},e.prototype.SetSprite=function(t,e){return r(this,void 0,void 0,function(){var i=this;return a(this,function(n){return[2,new Promise(function(n,o){var r=i.GetSprite(t);r&&s.default.loadRes(e,cc.SpriteFrame).then(function(t){cc.isValid(i.node)&&(r.spriteFrame=t,n(null))})})]})})},e.prototype.GetText=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(cc.Label);var e=this.GetGameObject(t);return e?e.getComponent(cc.Label):null},e.prototype.GetProgressBar=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(cc.ProgressBar);var e=this.GetGameObject(t);return e?e.getComponent(cc.ProgressBar):null},e.prototype.GetButton=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(cc.Button);var e=this.GetGameObject(t);return e?e.getComponent(cc.Button):null},e.prototype.GetInputField=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(cc.EditBox);var e=this.GetGameObject(t);return e?e.getComponent(cc.EditBox):null},e.prototype.GetSlider=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(cc.Slider);var e=this.GetGameObject(t);return e?e.getComponent(cc.Slider):null},e.prototype.SetText=function(t,e){this.GetText(t)&&(this.GetText(t).string=e)},e.prototype.SetInputText=function(t,e){this.GetInputField(t)&&(this.GetInputField(t).string=e)},e.prototype.SetProgressBar=function(t,e){this.GetProgressBar(t)&&(this.GetProgressBar(t).progress=e)},e.prototype._isSkipNode=function(t){return this.node!=t&&null!=t.getComponent(i)},e.prototype._addClickEvent=function(t){if(!this._isSkipNode(t))for(var e=0;e<t.childrenCount;++e){var i=t.children[e];this._isSkipNode(i)||(i.getComponent(cc.Button)&&s.default.addClickEvent(i,this.node,cc.js.getClassName(this),"onBtnClicked",i.getComponent(cc.Button).target),this._addClickEvent(i))}},e.prototype.getChildByName=function(t,e){return cc.find(t,e||this.node)},e.prototype.startAnim=function(){if(this.node){this.node.opacity=0,this.node.active=!0,this.node.setScale(.8,.8);var t=cc.delayTime(.1),e=cc.fadeIn(.1),i=cc.scaleTo(.1,1);this.node.runAction(cc.spawn(t.clone(),e,t.clone(),i))}},e.prototype.shutAnim=function(){this.node&&(this.node.active=!1,this.node.parent=null,this.node.destroy())},e.prototype.closeUI=function(){this.shutAnim()},e.prototype.onDestroy=function(){for(var t=0;t<this.events.length;++t)c.default.Instance().unregister(this,this.events[t])},e.prototype.rigester=function(t,e){this.events.push(t),c.default.Instance().register(this,t,e)},e.prototype.unregister=function(t){c.default.Instance().unregister(this,t)},e.prototype.dispatch=function(t){for(var e,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];(e=c.default.Instance()).dispatch.apply(e,[t].concat(i))},e.prototype.playSkAni=function(t,e,i,n,o){return void 0===o&&(o=-1),r(this,void 0,void 0,function(){var r,c,l;return a(this,function(a){switch(a.label){case 0:return(r=new cc.Node).parent=i,r.position=n,c=r.addComponent(sp.Skeleton),[4,s.default.loadRes(t,sp.SkeletonData)];case 1:return l=a.sent(),c.skeletonData=l,c.premultipliedAlpha=!1,c.setAnimation(0,e,!1),-1!=o&&r.runAction(cc.sequence(cc.delayTime(o),cc.callFunc(function(){r.parent=null}))),[2,r]}})})},e=i=o([u],e)}(cc.Component));i.default=p,cc._RF.pop()},{"../event/GameEvent":"GameEvent","../utils/Utils":"Utils"}],BigNumber:[function(t,e,i){"use strict";cc._RF.push(e,"29779EDnrJPKp0TmDE+JGoq","BigNumber");var n=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,r=o.ccclass,a=(o.property,function(){function t(){}var e;return e=t,t.getN=function(t){for(var i=0;i<e.aLetters.length;){if(e.aLetters[i]==t)return Math.pow(10,e.aLetters[i+1]);i+=2}return 0},t.getLargeString=function(t,i,n){if(void 0===i&&(i="K"),void 0===n&&(n=!0),0==t)return t+"";for(var o=NaN,r=Math.round(t/Math.abs(t)),a=t=Math.abs(t),c=0,s=0,l=0,u=0;u<e.aLetters.length;){if(e.aLetters[u]==i){s=u;break}u+=2}if(t<Math.pow(10,e.aLetters[s+1]))c=-1;else{for(o=Math.pow(10,e.aLetters[s+1]),c=s/2;a/1e3>=o;)a/=1e3,c++;for(;a/1e3>=1e3;)a/=1e3}return-1==c?e.addSeparators(Math.round((t-.5)*r).toString()):(a/1e3<10?l=2:a/1e3<100&&(l=1),a/=Math.pow(10,3-l),a=parseInt(a),a/=Math.pow(10,l),n?(a*r).toFixed(2)+""+e.aLetters[2*c]:(a*r).toString()+""+e.aLetters[2*c])},t.addSeparators=function(t,e){void 0===e&&(e=",");var i="-"==t.charAt(0);i&&(t=t.substr(1));for(var n="",o=0,r=t.length-1;r>0;)n=t.charAt(r)+n,++o%3==0&&(n=e+n),r-=1;return n=t.charAt(0)+n,i&&(n="-"+n),n},t.convertToLargeString=function(t){return e.getStringOfNumber(t)},t.getStringOfNumber=function(t,e,i,n){void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=!1);var o=1;n&&(o=10);var r=Math.round(t);if(Math.round(t)>=1e6&&r<1e9&&e)return(Math.round(r/1e3/o)/(1e3/o)).toString()+" M";if(r>=1e9&&r<1e12)return(Math.round(r/1e6/o)/(1e3/o)).toString()+" B";if(r>=1e12&&r<1e15)return(Math.round(r/1e9/o)/(1e3/o)).toString()+" T";if(r>=1e15&&r<1e18)return(Math.round(r/1e12/o)/(1e3/o)).toString()+" q";if(r>=1e18&&r<1e21)return(Math.round(r/1e15/o)/(1e3/o)).toString()+" Qq";if(r>=1e21&&r<1e24)return(Math.round(r/1e18/o)/(1e3/o)).toString()+" s";if(r>=1e24&&r<1e27)return(Math.round(r/1e21/o)/(1e3/o)).toString()+" Ss";if(r>=1e27&&r<1e30)return(Math.round(r/1e24/o)/(1e3/o)).toString()+" O";if(r>=1e30&&r<1e33)return(Math.round(r/1e27/o)/(1e3/o)).toString()+" N";if(r>=1e33&&r<1e26)return(Math.round(r/1e30/o)/(1e3/o)).toString()+" d";if(r>=1e26&&r<1e29)return(Math.round(r/1e33/o)/(1e3/o)).toString()+" U";if(r>=1e29&&r<1e32)return(Math.round(r/1e26/o)/(1e3/o)).toString()+" Dd";var a=" ";i&&(a=",");for(var c="",s=String(Math.round(t)),l=String(Math.round(t)).length-1;l>=0;)3==(c=s.charAt(l)+c).length&&0!=l&&(c=a+c),7==c.length&&0!=l&&(c=a+c),l-=1;return c},t.aLetters=["K",3,"M",6,"B",9,"T",12,"aa",15,"bb",18,"cc",21,"dd",24,"ee",27,"ff",30,"gg",33,"hh",36,"ii",39,"jj",42,"kk",45,"ll",48,"mm",51,"nn",54,"oo",57,"pp",60,"qq",63,"rr",66,"ss",69,"tt",72,"uu",75,"vv",78,"ww",81,"xx",84,"yy",87,"zz",90,"aaa",93,"bbb",96,"ccc",99,"ddd",102,"eee",105,"fff",108,"ggg",111,"hhh",114,"iii",117,"jjj",120,"kkk",123,"lll",126,"mmm",129,"nnn",132,"ooo",135,"ppp",138,"qqq",141,"rrr",144,"sss",147,"ttt",150,"uuu",153,"vvv",156,"www",159,"xxx",162,"yyy",165,"zzz"],t=e=n([r],t)}());i.default=a,cc._RF.pop()},{}],BossCommingUI:[function(t,e,i){"use strict";cc._RF.push(e,"d79a1IGYc5Ds7RQV9hCY0sd","BossCommingUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../script/framwork/BaseUI"),a=t("../../script/utils/AudioMgr"),c=cc._decorator,s=c.ccclass,l=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){var t=this;a.default.Instance().playSFX("Arlam"),this.node.runAction(cc.sequence(cc.delayTime(3),cc.callFunc(function(){t.closeUI()})))},e=o([s],e)}(r.default));i.default=l,cc._RF.pop()},{"../../script/framwork/BaseUI":"BaseUI","../../script/utils/AudioMgr":"AudioMgr"}],Bullet:[function(t,e,i){"use strict";cc._RF.push(e,"7b304r11c5BdrPI27Yo4iN5","Bullet");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function a(t){try{s(n.next(t))}catch(t){r(t)}}function c(t){try{s(n.throw(t))}catch(t){r(t)}}function s(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(a,c)}s((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var c=t("../../script/framwork/BaseUI"),s=t("../../script/utils/Utils"),l=t("../../script/game/DB"),u=t("./Enemy"),p=cc._decorator,h=p.ccclass,d=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.target=null,e.sped=700,e.plantlv=0,e}return n(e,t),e.prototype.start=function(){this.GetGameObject("trail2").opacity=0,this.GetGameObject("trail2").runAction(cc.fadeTo(.4,255)),this.node.scale=1.2},e.prototype.update=function(t){if(this.target){var e=this.target.position.add(cc.v3(0,80,0)).sub(this.node.position);if(e.mag()<this.sped*t*2)return this.target.getComponent(u.default).hit(this.plantlv),this.node.destroy(),void this.node.removeFromParent(!0);var i=e.normalize().mul(this.sped*t);this.node.position=this.node.position.add(i),this.node.angle=180-180*cc.v2(e.x,e.y).signAngle(cc.v2(1,0))/Math.PI}else this.node.removeFromParent(!0)},e.prototype.setInfo=function(t,e){return r(this,void 0,void 0,function(){var i;return a(this,function(n){switch(n.label){case 0:return e=Math.min(e,l.MAX_PLANT),this.plantlv=e,this.target=t,l.DB_plant[e-1],i=this.GetSprite("sp"),[4,s.default.loadRes("texture/bullets/"+(e-1),cc.SpriteFrame)];case 1:return i.spriteFrame=n.sent(),this.GetGameObject("trail2").color=cc.Color.RED.fromHEX(String(l.DB_plant[e-1][9])),this.GetGameObject("trail2").height=this.GetGameObject("sp").height,[2]}})})},e=o([h],e)}(c.default));i.default=d,cc._RF.pop()},{"../../script/framwork/BaseUI":"BaseUI","../../script/game/DB":"DB","../../script/utils/Utils":"Utils","./Enemy":"Enemy"}],ConfigManager:[function(t,e,i){"use strict";cc._RF.push(e,"9780cLuR0VKypQXZeycd6Qq","ConfigManager");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function a(t){try{s(n.next(t))}catch(t){r(t)}}function c(t){try{s(n.throw(t))}catch(t){r(t)}}function s(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(a,c)}s((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bInit=!1,e}return n(e,t),e.prototype.loadConfig=function(){return o(this,void 0,void 0,function(){return r(this,function(t){return this.bInit?[2]:(this.bInit=!0,[2])})})},e}(t("./Singleton").default);i.default=a;cc._RF.pop()},{"./Singleton":"Singleton"}],DB:[function(t,e,i){"use strict";cc._RF.push(e,"7de6ch9oxJOZopj+KFc/W5J","DB"),Object.defineProperty(i,"__esModule",{value:!0}),i.MAX_LEVEL=10,i.MAX_PLANT=20,i.DB_level={"1_1":[1,1,3,1,5,2,1],"1_2":[1,2,3,1,7,2,1],"1_3":[1,3,3,101,1,2,0],"2_1":[2,1,4,2,5,3,1],"2_2":[2,2,4,2,7,3,1],"2_3":[2,3,4,2,9,3,1],"2_4":[2,4,4,102,1,3,0],"3_1":[3,1,5,3,5,4,1],"3_2":[3,2,5,3,7,4,1],"3_3":[3,3,5,3,9,4,1],"3_4":[3,4,5,3,11,4,1],"3_5":[3,5,5,103,1,4,0],"4_1":[4,1,5,4,5,5,1],"4_2":[4,2,5,4,7,5,1],"4_3":[4,3,5,4,9,5,1],"4_4":[4,4,5,4,11,5,1],"4_5":[4,5,5,104,1,5,0],"5_1":[5,1,5,5,5,6,1],"5_2":[5,2,5,5,7,6,1],"5_3":[5,3,5,5,9,6,1],"5_4":[5,4,5,5,11,6,1],"5_5":[5,5,5,105,1,6,0],"6_1":[6,1,5,6,5,7,1],"6_2":[6,2,5,6,7,7,1],"6_3":[6,3,5,6,9,7,1],"6_4":[6,4,5,6,11,7,1],"6_5":[6,5,5,106,1,7,0],"7_1":[7,1,5,7,5,8,1],"7_2":[7,2,5,7,7,8,1],"7_3":[7,3,5,7,9,8,1],"7_4":[7,4,5,7,11,8,1],"7_5":[7,5,5,107,1,8,0],"8_1":[8,1,5,8,5,9,1],"8_2":[8,2,5,8,7,9,1],"8_3":[8,3,5,8,9,9,1],"8_4":[8,4,5,8,11,9,1],"8_5":[8,5,5,108,1,9,0],"9_1":[9,1,5,9,5,10,1],"9_2":[9,2,5,9,7,10,1],"9_3":[9,3,5,9,9,10,1],"9_4":[9,4,5,9,11,10,1],"9_5":[9,5,5,109,1,10,0],"10_1":[10,1,5,10,5,11,1],"10_2":[10,2,5,10,7,11,1],"10_3":[10,3,5,10,9,11,1],"10_4":[10,4,5,10,11,11,1],"10_5":[10,5,5,110,1,11,0]},i.DB_levelupGem={3:[3,3],5:[5,3],8:[8,3],11:[11,3],14:[14,5],17:[17,5],19:[19,5],21:[21,5],23:[23,5],25:[25,5],27:[27,5],29:[29,5],31:[31,8],33:[33,8],35:[35,8],37:[37,8],39:[39,8],41:[41,8],43:[43,8],45:[45,8],47:[47,10],49:[49,10],51:[51,10],53:[53,10],55:[55,10],57:[57,10],59:[59,10]},i.DB_plant=[[1,1,10,"1|10",4,100,0,"","","#FEDE55","01"],[2,.96,16,"2|10",9,1548,0,"","","#F2AA1A","07"],[3,.92,25,"3|5",19,6969,0,"","","#B4E253","15"],[4,.88,42,"1|11",41,18539,0,"","","#F4C712","32"],[5,.84,75,"2|11",86,49314,0,"","","#FEE056","05"],[6,.81,140,"3|5.5",181,131176,0,"","","#ECBE4B","04"],[7,.78,293,"1|12",380,348928,0,"","","#99E448","14"],[8,.75,601,"2|12",798,928149,0,"","","#D4E5EC","16"],[9,.72,1214,"3|6",1676,2468878,0,"","","#1971D6","06"],[10,.69,2536,"1|13",3520,6567217,0,"","","#E9E178","24"],[11,.67,5307,"2|13",7392,17468797,6,"","","#5B7D15","17"],[12,.65,11615,"3|6.5",15523,46467e3,8,"","","#FDE054","22"],[13,.63,24392,"1|14",32598,123602221,10,"","","#E2B845","08"],[14,.61,51224,"2|14",68455,328781909,13,"","","#E66823","33"],[15,.6,107572,"3|7",143756,874559877,17,"","","#AF452D","11"],[16,.59,225903,"1|15",301888,2326329273,22,"","","#C4A261","23"],[17,.58,474396,"2|15",633965,6188035867,30,"","","#FAEB2E","29"],[18,.57,996232,"3|7.5",1331326,16460175406,40,"","","#BCEC7F","28"],[19,.56,2092088,"1|16",2795784,43784066580,50,"","","#FEFDFF","39"],[20,.55,4393386,"2|16",5871147,116465617103,60,"",",","#FDDB2C","50"]],i.DB_shopSort={1:[1,"M","","","","","","","",""],2:[2,"U","M","","","","","","",""],3:[3,"U","U","M","","","","","",""],4:[4,"U","U","M","M","","","","",""],5:[5,"U","U","M","M","M","","","",""],6:[6,"U","U","M","M","M","M","","",""],7:[7,"U","U","AD","M","M","M","M","",""],8:[8,"U","U","AD","M","M","M","M","M",""],9:[9,"U","U","AD","M","M","M","M","M","M"],10:[10,"U","U","AD","M","M","M","M","M","M"],11:[11,"U","U","AD","M","M","M","M","M","M"],12:[12,"U","U","M","AD","M","M","M","M","M"],13:[13,"U","U","G","M","AD","M","M","M","M"],14:[14,"U","U","G","G","M","AD","M","M","M"],15:[15,"U","U","G","G","M","AD","M","M","M"],16:[16,"U","U","G","G","M","AD","M","M","M"],17:[17,"U","U","G","G","M","AD","M","M","M"],18:[18,"U","U","G","G","M","AD","M","M","M"],19:[19,"U","U","G","G","M","AD","M","M","M"],20:[20,"U","U","G","G","M","AD","M","M","M"],21:[21,"U","U","G","G","M","AD","M","M","M"],22:[22,"U","U","G","G","M","AD","M","M","M"],23:[23,"U","U","G","G","M","M","AD","M","M"],24:[24,"U","U","G","G","M","M","AD","M","M"],25:[25,"U","U","G","G","M","M","AD","M","M"],26:[26,"U","U","G","G","M","M","AD","M","M"],27:[27,"U","U","G","G","M","M","AD","M","M"],28:[28,"U","U","G","G","M","M","AD","M","M"],29:[29,"U","U","G","G","M","M","AD","M","M"],30:[30,"U","U","G","G","M","M","AD","M","M"],31:[31,"U","U","G","G","M","M","M","AD","M"],32:[32,"U","U","G","G","M","M","M","AD","M"],33:[33,"U","U","G","G","M","M","M","AD","M"],34:[34,"U","U","G","G","M","M","M","AD","M"],35:[35,"U","U","G","G","M","M","M","AD","M"],36:[36,"U","U","G","G","M","M","M","AD","M"],37:[37,"U","U","G","G","M","M","M","AD","M"],38:[38,"U","U","G","G","M","M","M","AD","M"],39:[39,"U","U","G","G","M","M","M","AD","M"],40:[40,"U","U","G","G","M","M","M","AD","M"],41:[41,"U","U","G","G","M","M","M","AD","M"],42:[42,"U","U","G","G","M","M","M","AD","M"],43:[43,"U","U","G","G","M","M","M","AD","M"],44:[44,"U","U","G","G","M","M","M","AD","M"],45:[45,"U","U","G","G","M","M","M","AD","M"],46:[46,"U","U","G","G","M","M","M","AD","M"],47:[47,"U","U","G","G","M","M","M","AD","M"],48:[48,"U","U","G","G","M","M","M","AD","M"],49:[49,"U","U","G","G","M","M","M","AD","M"],50:[50,"U","U","G","G","M","M","M","AD","M"],51:[51,"U","U","G","G","M","M","M","AD","M"],52:[52,"U","U","G","G","M","M","M","AD","M"],53:[53,"U","U","G","G","M","M","M","AD","M"],54:[54,"U","U","G","G","M","M","M","AD","M"],55:[55,"U","U","G","G","M","M","M","AD","M"],56:[56,"U","U","G","G","M","M","M","AD","M"],57:[57,"U","U","G","G","M","M","M","AD","M"],58:[58,"U","U","G","G","M","M","M","AD","M"],59:[59,"U","U","G","G","M","M","M","AD","M"],60:[60,"U","U","G","G","M","M","M","AD","M"]},i.DB_zombie={1:[1,57,.862529,137,"",""],2:[2,163,.90565545,170,"",""],3:[3,413,.9509382225,432,"",""],4:[4,705,.998485133625,736,"",""],5:[5,1166,1.04840939081,1218,"",""],6:[6,1636,1.10082985969,1709,"",""],7:[7,2470,1.15587135329,2580,"",""],8:[8,3657,1.21366492019,3820,"",""],9:[9,8104,1.27434816625,8467,"",""],10:[10,17947,1.33806557522,18751,"",""],11:[11,39752,1.40496885378,41533,"",""],101:[101,1567,.575019333672,1637,"",""],102:[102,2351,.6037703,2456,"",""],103:[103,4231,.633958815,4421,"",""],104:[104,7680,.66565675575,8024,"",""],105:[105,14576,.698939593538,15229,"",""],106:[106,29152,.733886573468,30458,"",""],107:[107,61754,.770580902192,64520,"",""],108:[108,137144,.809109946794,143287,"",""],109:[109,303912,.84956544383,317524,"",""],110:[110,673026,.892043716478,703171,"",""]},i.DB_droneRewards={1:[1,1],2:[2,1],3:[3,1],4:[4,2],5:[5,3],6:[6,3],7:[7,3],8:[8,4],9:[9,4],10:[10,4],11:[11,5],12:[12,5],13:[13,6],14:[14,6],15:[15,7],16:[16,7],17:[17,8],18:[18,9],19:[19,10],20:[20,11],21:[21,12],22:[22,13],23:[23,14],24:[24,15],25:[25,16],26:[26,16],27:[27,17],28:[28,18],29:[29,19],30:[30,20],31:[31,21],32:[32,22],33:[33,23],34:[34,24],35:[35,25],36:[36,26],37:[37,27],38:[38,28],39:[39,29],40:[40,30],41:[41,31],42:[42,32],43:[43,33],44:[44,34],45:[45,35],46:[46,36],47:[47,37],48:[48,38],49:[49,39],50:[50,40],51:[51,41],52:[52,42],53:[53,43],54:[54,44],55:[55,45],56:[56,46],57:[57,47],58:[58,48],59:[59,49],60:[60,50]},i.DB_slot=[{id:1,type:0,price:0},{id:2,type:0,price:0},{id:3,type:0,price:0},{id:4,type:0,price:0},{id:5,type:0,price:0},{id:6,type:0,price:100},{id:7,type:0,price:1500},{id:8,type:0,price:10560},{id:9,type:1,price:20},{id:10,type:1,price:50},{id:11,type:1,price:100},{id:12,type:1,price:200}],cc._RF.pop()},{}],DataManager:[function(t,e,i){"use strict";cc._RF.push(e,"8fa84j3BbNPpL1hUWIcuqxq","DataManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=[];var o=function(){function t(){}return t.prototype.getUploadData=function(){for(var t={},e=0;e<n.length;++e)t[n[e]]=this[n[e]];return t},t}();i.default=o,cc._RF.pop()},{}],Data:[function(t,e,i){"use strict";cc._RF.push(e,"33e40/I8TNAE6QREhbIVC7x","Data"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../game/UserModel"),o=t("../utils/Utils"),r=t("../utils/AudioMgr"),a=t("../game/GameConst"),c=function(){function t(){}return t.save=function(e){void 0===e&&(e=!1);var i={};i.user=t.user.getUploadData(),t.savedata(i,e)},t.loadData=function(){var e=cc.sys.localStorage.getItem(a.default.local_data_key);e?(e=JSON.parse(e),t.user.setData(e.user)):(cc.sys.localStorage.setItem("bgmVolume",1),cc.sys.localStorage.setItem("sfxVolume",1),r.default.Instance().sfxVolume=1,r.default.Instance().bgmVolume=1)},t.savedata=function(t,e){void 0===e&&(e=!1),cc.sys.localStorage.setItem("savedatatime",o.default.getServerTime());var i=JSON.stringify(t);cc.sys.localStorage.setItem(a.default.local_data_key,i)},t.user=new n.default,t}();i.default=c,cc._RF.pop()},{"../game/GameConst":"GameConst","../game/UserModel":"UserModel","../utils/AudioMgr":"AudioMgr","../utils/Utils":"Utils"}],DebugTools:[function(t,e,i){"use strict";cc._RF.push(e,"afc5a/e3ihDopuoBgs/d9wY","DebugTools");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,c=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){cc.sys.platform==cc.sys.DESKTOP_BROWSER&&(this.addBtn("\u6e05\u9664\u6570\u636e",function(){}),this.addBtn("\u91d1\u5e01+\u5f88\u591a",function(){}),this.addBtn("\u94bb\u77f3+\u5f88\u591a",function(){}),this.addBtn("1\u500d\u6570",function(){}),this.addBtn("4\u500d\u6570",function(){}),this.addBtn("lv++",function(){}))},e.prototype.addBtn=function(t,e){},e=o([a],e)}(cc.Component));i.default=c,cc._RF.pop()},{}],Enemy:[function(t,e,i){"use strict";cc._RF.push(e,"7abb6Nw6whC5Ira83PINgLj","Enemy");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function a(t){try{s(n.next(t))}catch(t){r(t)}}function c(t){try{s(n.throw(t))}catch(t){r(t)}}function s(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(a,c)}s((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var c=t("../../script/framwork/BaseUI"),s=t("../../script/game/HallScene"),l=t("../../script/game/DB"),u=t("../../script/utils/Utils"),p=t("../../script/manager/Data"),h=t("../../script/utils/AudioMgr"),d=cc._decorator,f=d.ccclass,_=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getcoin_pre=null,e.maxhp=0,e.hp=0,e.money=0,e.type=0,e.bfrozen=!1,e.pathindex=1,e.sped=1,e.base_speed=50,e.redendtime=0,e.purpleendtime=0,e}return n(e,t),e.prototype.getBossMoney=function(){return 2==this.type?(p.default.user.double_income_time>u.default.getServerTime()&&(this.money*=2),(this.maxhp-this.hp)/this.maxhp*this.money):0},e.prototype.setID=function(t,e){return r(this,void 0,void 0,function(){var i,n;return a(this,function(o){switch(o.label){case 0:return this.type=e?1:0,i=l.DB_zombie[t+""],t>100&&(t-=100,this.type=2),t>52&&(t=u.default.getRandomInt(1,52)),this.sped=i[2]*this.base_speed,this.maxhp=i[1],this.hp=this.maxhp,this.money=Math.floor(i[3]*u.default.getRandom(.8,1.2)),this.node.position=s.default.Instance.path[0],this.node.scale=0==this.type?.8:1.1,this.GetGameObject("sp").scaleX=.5,25==t?h.default.Instance().playSFX("dog"):13==t?h.default.Instance().playSFX("pig"):h.default.Instance().playSFX(u.default.getRandom(0,1)<.6?"zb1":"zb2"),n=this.GetSkeleton("sp"),[4,u.default.loadRes("spine/enemy"+t,sp.SkeletonData)];case 1:return n.skeletonData=o.sent(),this.GetSkeleton("sp").setAnimation(0,"run",!0),this.GetGameObject("New ProgressBar").opacity=0,[2]}})})},e.prototype.hit=function(t){var e=this;if(!(this.hp<=0)){var i=l.DB_plant[t-1],n=String(i[3]).split("|"),o=Number(n[0]),r=Number(n[1]),a=Number(i[2]),c=!1;if(u.default.getRandom(0,100)<r&&(1==o?this.slowdown():2==o?(a*=2,c=!0):3==o&&this.frozen()),p.default.user.lv<3?this.hp-=a/4:p.default.user.lv<6?this.hp-=a/3:p.default.user.lv<9?this.hp-=a/2:this.hp-=a/1.5,this.hp=Math.max(this.hp,0),this.SetProgressBar("New ProgressBar",this.hp/this.maxhp),this.GetGameObject("New ProgressBar").stopAllActions(),this.GetGameObject("New ProgressBar").opacity=255,this.GetGameObject("New ProgressBar").runAction(cc.sequence(cc.delayTime(1),cc.fadeTo(.2,0))),c?this.showWLBaoji(a,u.default.getRandom(0,1)>.5):this.showFSHurt(a,u.default.getRandom(0,1)>.5),this.hp<=0){if(s.default.Instance.removeenemy(this.node,!1),this.GetGameObject("sp").runAction(cc.sequence(cc.delayTime(.5),cc.fadeTo(.2,0),cc.callFunc(function(){e.node.removeFromParent(!0)}))),p.default.user.double_income_time>u.default.getServerTime()&&(this.money*=2),2!=this.type){var d=cc.instantiate(this.getcoin_pre);d.parent=this.node.parent,d.getChildByName("lbl_add_coin").getComponent(cc.Label).string=u.default.formatNumber(this.money),d.position=this.node.position.add(cc.v3(0,50,0)),d.zIndex=1e3,d.scale=.5,p.default.user.coin+=Math.floor(this.money/2),d.runAction(cc.sequence(cc.spawn(cc.scaleTo(.2,1.3),cc.moveBy(.2,0,80)),cc.delayTime(.8),cc.spawn(cc.moveBy(.5,50),cc.fadeTo(.5,50)),cc.removeSelf()))}this.playSkAni("spine/other/zhuoshao","effect",this.node,cc.v3(0,75,0),1).then(function(t){t.scale=2})}else this.playSkAni("spine/other/jizhong","animation",this.node,cc.v3(0,75,0),1),this.redendtime=u.default.getServerTime()+300;h.default.Instance().playSFX("hit")}},e.prototype.slowdown=function(){var t=this;h.default.Instance().playSFX("skill_slow"),this.GetSkeleton("sp").timeScale=.5,this.GetGameObject("jiansu").active=!0,this.GetGameObject("sp").stopAllActions(),this.GetGameObject("sp").runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){t.GetGameObject("sp").color=cc.Color.WHITE,t.GetSkeleton("sp").timeScale=1,t.GetGameObject("jiansu").active=!1})))},e.prototype.frozen=function(){var t=this;h.default.Instance().playSFX("skill_freeze"),this.bfrozen=!0,this.GetGameObject("fx_stun").stopAllActions(),this.GetGameObject("fx_stun").active=!0,this.purpleendtime=u.default.getServerTime()+1e3,this.GetSkeleton("sp").paused=!0,this.GetGameObject("fx_stun").runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){t.GetGameObject("fx_stun").active=!1,t.GetSkeleton("sp").paused=!1,t.bfrozen=!1})))},e.prototype.update=function(t){if(this.redendtime>u.default.getServerTime()?this.GetGameObject("sp").color=cc.Color.RED.fromHEX("#7C82DE"):this.purpleendtime>u.default.getServerTime()?this.GetGameObject("sp").color=cc.Color.RED.fromHEX("#ED7373"):this.GetGameObject("sp").color=cc.Color.WHITE,!this.bfrozen&&s.default.Instance.path[this.pathindex]){var e=s.default.Instance.path[this.pathindex].sub(this.node.position);if(e.mag()<this.sped*t)this.node.position=s.default.Instance.path[this.pathindex],this.pathindex++,3==this.pathindex&&(this.GetGameObject("sp").scaleX=-.5),this.pathindex>=s.default.Instance.path.length&&(s.default.Instance.removeenemy(this.node,!0),this.node.removeFromParent(!0));else{var i=e.normalize().mul(this.sped*t);this.node.position=this.node.position.add(i)}}},e.prototype.showFSHurt=function(t,e){void 0===e&&(e=!1);var i,n=cc.instantiate(this.GetGameObject("fs_hurt"));n.parent=this.node,e&&(n.x*=-1),n.getComponent(cc.Label).string=u.default.formatCoin(t),n.active=!0,i=e?[cc.v2(-10,50),cc.v2(-40,60),cc.v2(-60,20)]:[cc.v2(10,50),cc.v2(40,60),cc.v2(60,20)];var o=cc.bezierBy(1,i);n.runAction(cc.sequence(cc.spawn(cc.scaleTo(1,.6),o),cc.removeSelf()))},e.prototype.showWLBaoji=function(t,e){void 0===e&&(e=!1),h.default.Instance().playSFX("skill_crit");var i,n,o=cc.instantiate(this.GetGameObject("wl_baoji"));o.parent=this.node,e&&(o.x*=-1),o.getComponent(cc.Label).string=u.default.formatCoin(t),o.active=!0,o.scale=.2,e?(i=[cc.v2(-5,20),cc.v2(-8,30),cc.v2(-10,30)],n=[cc.v2(-5,-20),cc.v2(-8,-30),cc.v2(-10,-30)]):(i=[cc.v2(5,20),cc.v2(8,30),cc.v2(10,30)],n=[cc.v2(5,-20),cc.v2(8,-30),cc.v2(10,-30)]);var r=cc.bezierBy(.2,i),a=cc.bezierBy(.5,n);o.runAction(cc.sequence(cc.spawn(cc.scaleTo(.2,1),r),cc.delayTime(.5),cc.spawn(cc.scaleTo(.5,.2),a,cc.fadeOut(.5)),cc.removeSelf()))},o([_(cc.Prefab)],e.prototype,"getcoin_pre",void 0),e=o([f],e)}(c.default);i.default=m,cc._RF.pop()},{"../../script/framwork/BaseUI":"BaseUI","../../script/game/DB":"DB","../../script/game/HallScene":"HallScene","../../script/manager/Data":"Data","../../script/utils/AudioMgr":"AudioMgr","../../script/utils/Utils":"Utils"}],FairyBonusUI:[function(t,e,i){"use strict";cc._RF.push(e,"f1d79P4wcFK9KwHCsJWJWld","FairyBonusUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../script/framwork/BaseUI"),a=t("../../script/game/DB"),c=t("../../script/manager/Data"),s=t("../../script/framwork/MsgHints"),l=t("../../script/utils/AudioMgr"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.superPot=[],e}return n(e,t),e.prototype.start=function(){for(var t=c.default.user.GetMaxLv(),e=a.DB_droneRewards[t+""][1],i=0;i<2;i++)this.superPot.push(e)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this)},e.prototype.onBtnClicked=function(t,e){var i=this,n=t.target.name;switch(l.default.Instance().playSFX("click"),n){case"btn_close":this.closeUI();break;case"btn_ad":window.videoPlayEnd=function(){c.default.user.DropGiftPts=c.default.user.DropGiftPts.concat(i.superPot),i.closeUI()},window.playVideoAd();break;case"btn_gem":if(c.default.user.gem<10)return void s.default.show("\u94bb\u77f3\u4e0d\u8db3");c.default.user.gem-=10,c.default.user.DropGiftPts=c.default.user.DropGiftPts.concat(this.superPot),this.closeUI()}},e=o([p],e)}(r.default));i.default=h,cc._RF.pop()},{"../../script/framwork/BaseUI":"BaseUI","../../script/framwork/MsgHints":"MsgHints","../../script/game/DB":"DB","../../script/manager/Data":"Data","../../script/utils/AudioMgr":"AudioMgr"}],FairyItem:[function(t,e,i){"use strict";cc._RF.push(e,"fd0779orjRI8rleyDsPRVW2","FairyItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../script/framwork/BaseUI"),a=t("../../script/utils/AudioMgr"),c=t("../../script/utils/Utils"),s=cc._decorator,l=s.ccclass,u=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){var t=this;this.node.runAction(cc.sequence(cc.delayTime(10),cc.callFunc(function(){t.ChuXian()})))},e.prototype.ChuXian=function(){var t=this;this.node.runAction(cc.sequence(cc.callFunc(function(){t.node.position=cc.v3(-cc.winSize.width/2-200,cc.winSize.height/4-100)}),cc.moveTo(20,cc.winSize.width/2+200,cc.winSize.height/4-100)).repeatForever())},e.prototype.onBtnClicked=function(t,e){var i=this,n=t.target.name;switch(a.default.Instance().playSFX("click"),n){case"FairyItem":this.node.stopAllActions(),this.node.position=cc.v3(-cc.winSize.width/2-200,cc.winSize.height/4-100),this.node.runAction(cc.sequence(cc.delayTime(40),cc.callFunc(function(){i.ChuXian()}))),c.default.createUI("prefab/FairyBonusUI")}},e=o([l],e)}(r.default));i.default=u,cc._RF.pop()},{"../../script/framwork/BaseUI":"BaseUI","../../script/utils/AudioMgr":"AudioMgr","../../script/utils/Utils":"Utils"}],GameConst:[function(t,e,i){"use strict";cc._RF.push(e,"278a8hJybJP3aVcSqpkGbLn","GameConst"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){}return t.local_data_key="PVSZ1001",t.OPEN_SLOT="OPEN_SLOT",t.NEW_PLANT="NEW_PLANT",t.BUY_PLANT="BUY_PLANT",t}();i.default=n,i.GAME_NAME="PVSZ",cc._RF.pop()},{}],GameEvent:[function(t,e,i){"use strict";cc._RF.push(e,"7698aOBsGFKDogqTQs289dG","GameEvent");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventHash={},e.ower=null,e.type=null,e.callback=null,e}return n(e,t),e.prototype.register=function(t,e,i){var n={};n.ower=t,n.type=e,n.callback=i,this.eventHash.hasOwnProperty(e)||(this.eventHash[e]=[]),this.eventHash[e].push(n)},e.prototype.unregister=function(t,e){var i=this.eventHash[e];i&&i.length>0&&i.forEach(function(n,o){n.ower===t&&n.type===e&&i.splice(o,1)})},e.prototype.dispatch=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=this.eventHash[t];if(n&&n.length>0)for(var o in n){var r=n[o];r.callback&&r.callback.apply(r,e)}},e}(t("../manager/Singleton").default);i.default=o,cc._RF.pop()},{"../manager/Singleton":"Singleton"}],HTTP:[function(t,e,i){"use strict";cc._RF.push(e,"67bbbOsI39IGox3ery2aUUG","HTTP"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=(n.ccclass,n.property,function(){function t(){}return t.sendRequest=function(e,i,n,o,r){void 0===o&&(o=null),void 0===r&&(r=null);var a=new XMLHttpRequest,c="?";for(var s in i)"?"!=c&&(c+="&"),c+=s+"="+i[s];null==o&&(o=t.url);var l=o+e;return i&&(l+=encodeURI(c)),a.open("GET",l,!0),a.timeout=1e4,a.onload=function(){if(a.status>=200&&a.status<300||304==a.status){var t=JSON.parse(a.responseText);n&&n(t)}else a.abort()},a.ontimeout=function(t){cc.log(t),r&&r()},a.onabort=function(t){cc.log(t),r&&r()},a.onerror=function(t){cc.log(t),r&&r()},a.send(),a},t.url="https://www.mfxczz.cn/powerman/user/",t}());i.default=o,cc._RF.pop()},{}],HallScene:[function(t,e,i){"use strict";cc._RF.push(e,"b649a1nCtpCaLao7q4JfaAs","HallScene");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function a(t){try{s(n.next(t))}catch(t){r(t)}}function c(t){try{s(n.throw(t))}catch(t){r(t)}}function s(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(a,c)}s((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var c=t("../framwork/BaseUI"),s=t("../utils/Utils"),l=t("../manager/Data"),u=t("./SlotItem"),p=t("./SoldierItem"),h=t("../framwork/MsgHints"),d=t("../utils/AudioMgr"),f=t("../../resources/prefab/AdLayer"),_=t("../../resources/prefab/AdLayer"),m=t("./DB"),y=t("../../resources/prefab/Enemy"),v=t("../../resources/prefab/VictoryUI"),g=t("../../resources/prefab/LoseUI"),b=t("../../resources/prefab/OfflineAwardUI"),w=t("../../resources/prefab/ShopLayer"),I=cc._decorator,G=I.ccclass,O=I.property,M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.enemy_pre=null,e._lastdroptime=0,e.enemylist=[],e.wave_info=null,e.bFail=!1,e.createcomplete=!1,e.path=[],e.item_drag=null,e.autocomindexs=[-1,-1],e.items=[],e.bPauseAutoCom=!1,e.bInAutoCom=!1,e.pre_soldier=null,e.bChoosed=!1,e.touchPos=cc.Vec2.ZERO,e.touchendtime=0,e}var i;return n(e,t),i=e,Object.defineProperty(e,"Instance",{get:function(){return i._instance},enumerable:!0,configurable:!0}),e.prototype.addGem=function(){window.videoPlayEnd=function(){l.default.user.gem+=20},window.playVideoAd()},e.prototype.hidemergetips=function(){for(var t=0,e=this.GetGameObject("slots").children;t<e.length;t++){e[t].getChildByName("fx_ground_merge").active=!1}},e.prototype.showmergetips=function(t){for(var e=[],i=0,n=this.items;i<n.length;i++){var o=n[i];o.datacopy&&o.datacopy.lv==t&&0==o.droptype&&o.datacopy.lv<m.MAX_PLANT&&e.push(o.index)}for(var r=this.GetGameObject("slots"),a=0;a<r.children.length;++a)r.children[a].getChildByName("fx_ground_merge").active=e.indexOf(a)>=0},e.prototype.update=function(t){this.SetText("lbl_coin",s.default.formatNumber(l.default.user.coin)+""),this.SetText("lbl_gem",s.default.formatNumber(l.default.user.gem)+""),this.enemylist.sort(function(t,e){return e.y-t.y});for(var e=0;e<this.enemylist.length;++e)this.enemylist[e].zIndex=e;if(this._lastdroptime+=t,this._lastdroptime>25*(l.default.user.drop_plant_time>s.default.getServerTime()?.3:1)){if(this.item_drag.datacopy)return;var i=Math.max(1,l.default.user.GetMaxLv()-s.default.getRandomInt(6,9));this.tryBuyPlant(i,3),this._lastdroptime=0}0!=this.touchendtime&&s.default.getServerTime()-this.touchendtime>5e3&&this.mergetip(),this.updateBuyButton()},e.prototype.showImage=function(t){return r(this,void 0,void 0,function(){var e,i;return a(this,function(n){switch(n.label){case 0:return e=new cc.Node,i=e.addComponent(cc.Sprite),[4,s.default.loadRes(t,cc.SpriteFrame)];case 1:return i.spriteFrame=n.sent(),e.parent=this.node,e.y=200,e.scale=1.2,e.runAction(cc.sequence(cc.delayTime(2),cc.spawn(cc.moveBy(.5,0,100),cc.fadeTo(.5,0)),cc.removeSelf())),[2]}})})},e.prototype.removeenemy=function(t,e){e&&(this.bFail=!0);for(var i=this.enemylist.length-1;i>=0;--i)if(t==this.enemylist[i]){this.enemylist.splice(i,1);break}if(this.createcomplete&&0==this.enemylist.length){if(this.bFail)if(l.default.user.wave>=this.wave_info[2]){l.default.user.wave=1;var n=t.getComponent(y.default);s.default.createUI("prefab/LoseUI").then(function(t){t.getComponent(g.default).setInfo(n.getBossMoney())})}else l.default.user.wave=1,this.showImage("texture/defeat");else if(l.default.user.wave++,l.default.user.wave>this.wave_info[2]){var o=t.getComponent(y.default).getBossMoney();this.node.runAction(cc.sequence(cc.delayTime(1.2),cc.callFunc(function(){s.default.createUI("prefab/VictoryUI").then(function(t){t.getComponent(v.default).setInfo(o)})}))),l.default.user.wave=1,l.default.user.lv++,l.default.save(!0);var r=l.default.user.lv+"_"+l.default.user.wave;this.wave_info=m.DB_level[r]}else d.default.Instance().playSFX("win_wave"),this.playSkAni("spine/other/shengjichenggong","effect",this.node,cc.v3(0,150,0),2);this.createwave()}},e.prototype.createwave=function(){var t=this;this.bFail=!1,this.createcomplete=!1;var e=l.default.user.lv+"_"+l.default.user.wave;if(this.wave_info=m.DB_level[e],!this.wave_info){var i=m.MAX_LEVEL+"_"+l.default.user.wave;this.wave_info=m.DB_level[i]}l.default.user.wave==this.wave_info[2]?(d.default.Instance().playBGM("bgBoss"),this.node.runAction(cc.sequence(cc.delayTime(.8),cc.callFunc(function(){s.default.createUI("prefab/BossCommingUI")})))):1==l.default.user.wave&&d.default.Instance().playBGM("BGM1");for(var n,o=[],r=0;r<this.wave_info[4];++r)o.push(this.wave_info[3]);n=o.length;for(r=0;r<this.wave_info[6];++r)o.push(this.wave_info[5]);var a=function(e){var i=o[e];c.node.runAction(cc.sequence(cc.delayTime(2.2*e),cc.callFunc(function(){var r=cc.instantiate(t.enemy_pre);r.parent=t.GetGameObject("node_obj"),r.getComponent(y.default).setID(i,e>=n),t.enemylist.push(r),e==o.length-1&&(t.createcomplete=!0)})))},c=this;for(r=0;r<o.length;++r)a(r);this.SetText("lbl_cur_lv",l.default.user.lv+""),this.SetText("lbl_waves",l.default.user.wave+"/"+this.wave_info[2]),this.SetText("lbl_pre_lv",l.default.user.lv-1+""),this.SetText("lbl_nex_lv",l.default.user.lv+1+"")},e.prototype.initComposeItems=function(){for(var t=l.default.user.ComPlants,e={},i=t.length-1;i>=0;i--)t[i].lv>m.MAX_PLANT&&(t[i].lv=m.MAX_PLANT),1!=e[t[i].index]?e[t[i].index]=1:(t.splice(i,1),console.warn("\u9519\u8bef...\u4fee\u6b63"));for(i=t.length-1;i>=0;i--)this.items[t[i].index]&&this.items[t[i].index].setItemData(t[i])},e.prototype.getItemByPos=function(t){for(var e=0;e<this.items.length;++e)if(this.items[e].node.getBoundingBox().contains(t))return this.items[e].node.getComponent(p.default);return null},e.prototype.setdragitempos=function(t){t=this.GetGameObject("node_com").convertToWorldSpaceAR(t),t=this.GetGameObject("item_drag").parent.convertToNodeSpaceAR(t),this.GetGameObject("item_drag").position=t},e.prototype.start=function(){return r(this,void 0,void 0,function(){var t,e,n,o,r,c,p,h,d,m=this;return a(this,function(a){switch(a.label){case 0:for(this.hidemergetips(),i._instance=this,t=this.GetGameObject("slots"),e=0,n=0,o=t.children;n<o.length;n++)o[n].getComponent(u.default).setIndex(++e);return[4,this.initView()];case 1:for(a.sent(),this.node.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){if(m.tryAutocom(),!m.item_drag.node.active){if(l.default.user.DropGiftPts.length>0)m.tryBuyPlant(l.default.user.DropGiftPts[0],4)&&l.default.user.DropGiftPts.shift();if(l.default.user.AdBuyNotDrop.length>0)m.tryBuyPlant(l.default.user.AdBuyNotDrop[0],2)&&l.default.user.AdBuyNotDrop.shift()}})).repeatForever()),l.default.user.auto_com_time=Math.max(0,l.default.user.auto_com_time),l.default.user.double_income_time=Math.max(0,l.default.user.double_income_time),l.default.user.drop_plant_time=Math.max(0,l.default.user.drop_plant_time),l.default.user.double_att_time=Math.max(0,l.default.user.double_att_time),this.updateBuyButton(),r=(s.default.getServerTime()-l.default.user.serverTime)/1e3,0!=l.default.user.serverTime&&r>180&&(r=Math.min(21600,r),c=l.default.user.getOfflineEarning(r/60),s.default.createUI("prefab/OfflineAwardUI",null,function(t){t.getComponent(b.default).data=c})),p=0,h=this.GetGameObject("node_path").children;p<h.length;p++)d=h[p],this.path.push(d.position);return this.node.runAction(cc.sequence(cc.delayTime(3),cc.callFunc(function(){m.createwave()}))),this.GetGameObject("bottom").runAction(cc.sequence(cc.callFunc(function(){m.GetGameObject("att_x2_time").active=l.default.user.double_att_time-s.default.getServerTime()>0,m.GetGameObject("lvl_number").active=l.default.user.double_income_time-s.default.getServerTime()>0,m.GetGameObject("lbl_drop_plant").active=l.default.user.drop_plant_time-s.default.getServerTime()>0,l.default.user.double_att_time-s.default.getServerTime()>60*f.max_auto_double_att*1e3&&(l.default.user.double_att_time=s.default.getServerTime()),l.default.user.double_income_time-s.default.getServerTime()>60*f.max_auto_double_income*1e3&&(l.default.user.double_income_time=s.default.getServerTime()),l.default.user.auto_com_time-s.default.getServerTime()>60*f.max_auto_com*1e3&&(l.default.user.auto_com_time=s.default.getServerTime()),l.default.user.drop_plant_time-s.default.getServerTime()>60*_.max_drop_plant*1e3&&(l.default.user.drop_plant_time=s.default.getServerTime()),m.SetText("att_x2_time",s.default.getTimeStrByS((l.default.user.double_att_time-s.default.getServerTime())/1e3)),m.SetText("rewardx2_time",s.default.getTimeStrByS((l.default.user.double_income_time-s.default.getServerTime())/1e3)),l.default.user.auto_com_time-s.default.getServerTime()>0?(m.GetSkeleton("bt_auto_merge").setAnimation(0,"on",!0),m.SetText("auto_time",s.default.getTimeStrByS((l.default.user.auto_com_time-s.default.getServerTime())/1e3))):(m.GetSkeleton("bt_auto_merge").setAnimation(0,"off",!0),m.SetText("auto_time","\u81ea\u52a8\u5408\u6210")),m.SetText("lbl_drop_plant",s.default.getTimeStrByS((l.default.user.drop_plant_time-s.default.getServerTime())/1e3)),m.GetGameObject("tx_angry").active=!m.GetGameObject("att_x2_time").active,m.GetGameObject("fx_bt_angry").active=!m.GetGameObject("tx_angry").active,m.GetSkeleton("btn_double_coin").setAnimation(0,l.default.user.double_income_time-s.default.getServerTime()>0?"on":"off",!0),l.default.user.drop_plant_time-s.default.getServerTime()<0?m.GetSprite("bt_fast_gen_process_item").fillRange=0:m.GetSprite("bt_fast_gen_process_item").fillRange=(l.default.user.drop_plant_time-s.default.getServerTime())/1e3/60/_.max_drop_plant}),cc.delayTime(1)).repeatForever()),this.GetGameObject("btn_delete").opacity=0,this.GetGameObject("guild_0").active=0==l.default.user.guideIndex,[2]}})})},e.prototype.initView=function(){return r(this,void 0,void 0,function(){var t,e,i,n,o,r,c=this;return a(this,function(a){for(t=this.GetGameObject("node_com"),e=0,i=0;i<12;++i)(n=cc.instantiate(this.pre_soldier)).parent=t,n.position=this.GetGameObject("slots").children[i].position,n.name="itme"+e,(o=n.getComponent(p.default)).index=e,this.items.push(o),++e;return(r=cc.instantiate(this.pre_soldier)).parent=t.parent,r.name="item_drag",r.x=-1e3,this.item_drag=this.GetGameObject("item_drag").getComponent(p.default),this.item_drag.node.active=!1,this.item_drag.bDrag=!0,this.initComposeItems(),t.on(cc.Node.EventType.TOUCH_START,function(e){c.bPauseAutoCom=!0,c.GetGameObject("node_com").stopAllActions(),c.item_drag.node.active&&c.item_drag.datacopy&&(c.item_drag.node.stopAllActions(),c.item_drag.linkItem.setItemData(c.item_drag.datacopy),c.item_drag.node.active=!1,c.autocomindexs[0]=-1,c.autocomindexs[1]=-1,c.item_drag.linkItem=null,c.GetGameObject("node_com").stopAllActions(),cc.log("\u53d6\u6d88\u5f53\u524d\u5408\u6210")),c.item_drag.datacopy=null;var i=e.getLocation();i=t.convertToNodeSpaceAR(i);var n=c.getItemByPos(i);n&&0!=n.droptype&&(n.droptype=0,n.updateItem()),n&&n.datacopy&&0==n.droptype?(c.touchPos=i,c.bChoosed=!0,c.setdragitempos(n.node.position),c.item_drag.index=n.index,c.item_drag.setItemData(n.datacopy),c.item_drag.linkItem=n,c.showmergetips(n.datacopy.lv)):(c.item_drag.node.active=!1,c.autocomindexs[0]=-1,c.autocomindexs[1]=-1)},this),t.on(cc.Node.EventType.TOUCH_MOVE,function(e){var i=e.getLocation();if(i=t.convertToNodeSpaceAR(i),c.bChoosed&&i.sub(c.touchPos).mag()>15){if(null==c.item_drag.datacopy)return;c.GetGameObject("btn_delete").opacity=255,c.item_drag.node.active=!0,c.item_drag.linkItem.setItemData(null),c.setdragitempos(i);var n=c.GetGameObject("btn_delete").position;n=c.GetGameObject("btn_delete").parent.convertToWorldSpaceAR(n),e.getLocation().sub(cc.v2(n.x,n.y)).mag()<100?c.GetGameObject("btn_delete").scale=.55:c.GetGameObject("btn_delete").scale=.5}},this),t.on(cc.Node.EventType.TOUCH_END,this.docomp,this),t.on(cc.Node.EventType.TOUCH_CANCEL,this.docomp,this),[2]})})},e.prototype.tryAutocom=function(){var t=this;if(!this.bPauseAutoCom&&!this.bInAutoCom&&s.default.getServerTime()<l.default.user.auto_com_time&&!this.bInAutoCom){this.initComposeItems();for(var e,i=function(i){if(!n.items[i]||!n.items[i].datacopy)return"continue";for(var o=i+1;o<n.items.length;++o)if(n.items[o]&&n.items[o].datacopy){if(n.bInAutoCom)return{value:void 0};if(n.items[i].datacopy.lv==n.items[o].datacopy.lv&&0==n.items[i].droptype&&0==n.items[o].droptype&&n.items[i].datacopy.lv<m.MAX_PLANT)return n.autocomindexs[0]=n.items[i].index,n.autocomindexs[1]=n.items[o].index,n.item_drag.linkItem=n.items[o],n.item_drag.index=n.items[o].index,n.item_drag.setItemData(n.items[o].datacopy),n.item_drag.node.active=!0,n.items[o].setItemData(null),n.item_drag.node.position=n.items[o].node.position,n.setdragitempos(n.items[o].node),e=n.GetGameObject("node_com").convertToWorldSpaceAR(n.items[i].node.position),e=n.GetGameObject("item_drag").parent.convertToNodeSpaceAR(e),n.bInAutoCom=!0,n.item_drag.node.stopAllActions(),n.item_drag.node.runAction(cc.sequence(cc.moveTo(.13,cc.v2(e.x,e.y)),cc.callFunc(function(){t.comani(t.items[i]),t.bInAutoCom=!1}))),{value:void 0}}},n=this,o=0;o<this.items.length;++o){var r=i(o);if("object"==typeof r)return r.value}}},e.prototype.docomp=function(t){var e=this;this.touchendtime=s.default.getServerTime(),this.hidemergetips(),this.GetGameObject("btn_delete").stopAllActions(),this.GetGameObject("btn_delete").runAction(cc.sequence(cc.delayTime(2),cc.fadeTo(1,0))),this.GetGameObject("node_com").runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){e.bPauseAutoCom=!1,e.bInAutoCom=!1}))),this.bChoosed=!1;var i=t?t.getLocation():cc.Vec2.ZERO;if(this.item_drag.node.active){if(!this.item_drag.datacopy)return;var n=this.GetGameObject("btn_delete").position;if(n=this.GetGameObject("btn_delete").parent.convertToWorldSpaceAR(n),i.sub(cc.v2(n.x,n.y)).mag()<100){this.item_drag.node.active=!1,this.autocomindexs[0]=-1,this.autocomindexs[1]=-1,this.GetGameObject("btn_delete").scale=.5;for(var o=0,r=0;r<this.items.length;++r)this.items[r].datacopy&&o++;if(o<=2)return h.default.show("\u690d\u7269\u6570\u91cf\u8fc7\u5c11\u4e0d\u80fd\u5220\u9664"),this.item_drag.linkItem.setItemData(this.item_drag.datacopy),this.item_drag.linkItem=null,void(this.item_drag.node.active=!1);if(this.item_drag.datacopy.lv>=l.default.user.GetMaxLv())return h.default.show("\u6700\u9ad8\u7b49\u7ea7\u690d\u7269\u5c31\u4e0d\u5220\u9664\u4e86\u5427\uff01"),this.item_drag.linkItem.setItemData(this.item_drag.datacopy),this.item_drag.linkItem=null,void(this.item_drag.node.active=!1);l.default.user.DropPlant(this.item_drag.datacopy.index),this.item_drag.linkItem.setItemData(null),this.item_drag.linkItem=null}i=this.GetGameObject("node_com").convertToNodeSpaceAR(i);var a=this.getItemByPos(i);if(null==a||0==l.default.user.slots[a.index]||a==this.item_drag.linkItem||a&&0!=a.droptype)return this.item_drag.linkItem&&this.item_drag.linkItem.setItemData(this.item_drag.datacopy),this.item_drag.linkItem=null,this.item_drag.node.stopAllActions(),this.item_drag.node.active=!1,this.autocomindexs[0]=-1,void(this.autocomindexs[1]=-1);if(!a.datacopy)return this.item_drag.node.active=!1,this.autocomindexs[0]=-1,this.autocomindexs[1]=-1,l.default.user.CompMove(this.item_drag.linkItem.index,a.index),a.setItemData(this.item_drag.datacopy),this.item_drag.linkItem.setItemData(null),void(this.item_drag.linkItem=null);if(a.datacopy.open==this.item_drag.datacopy.open&&a.datacopy.lv==this.item_drag.datacopy.lv&&a.datacopy.index!=this.item_drag.datacopy.index&&0==a.droptype&&a.datacopy.lv<m.MAX_PLANT)this.comani(a);else{this.item_drag.node.active=!1,this.autocomindexs[0]=-1,this.autocomindexs[1]=-1,l.default.user.CompMove(this.item_drag.linkItem.index,a.index);var c=JSON.parse(JSON.stringify(a.datacopy));a.setItemData(this.item_drag.datacopy),this.item_drag.linkItem.setItemData(c)}}else{if(!t)return;this.item_drag.linkItem=null}},e.prototype.comani=function(t){d.default.Instance().playSFX("com");var e=l.default.user.ComposePlant(t.index,this.item_drag.datacopy.index);if(this.GetGameObject("guild_1").active=!1,1==l.default.user.guideIndex&&(l.default.user.guideIndex++,l.default.save()),e){var i=l.default.user.getPlantInfo(t.index);t.setItemData(i),this.GetGameObject("item_drag").active=!1,this.item_drag.datacopy=null,this.item_drag.linkItem=null,this.autocomindexs=[-1,-1];var n=this.GetGameObject("node_com").convertToWorldSpaceAR(t.node.position);n=this.GetGameObject("item_drag").parent.convertToNodeSpaceAR(n),this.playSkAni("spine/other/effect_hecheng","effect",this.GetGameObject("item_drag").parent,n.add(cc.v3(0,20,0)),1)}},e.prototype.updateBuyButton=function(){var t=l.default.user.GetMaxLv()-3;t<1&&(t=1),this.SetText("lbl_buy_cost",s.default.formatNumber(l.default.user.BuyPrice(t))),this.SetSprite("icon_buy","texture/plants/"+(t-1))},e.prototype.tryBuyPlant=function(t,e){for(var i=null,n=0;n<12;++n)if(0!=l.default.user.slots[n]&&!this.items[n].datacopy&&this.autocomindexs[0]!=n&&this.autocomindexs[1]!=n){i=this.items[n];break}if(t||(t=l.default.user.GetMaxLv()-3)<1&&(t=1),i){if(0==e){var o=l.default.user.BuyPrice(t);if(l.default.user.BuyPrice(t)>l.default.user.coin)return void h.default.show("\u91d1\u5e01\u4e0d\u8db3");l.default.user.coin-=o}else if(1==e){var r=Math.min(5,Number(m.DB_plant[t-1][6]));if(r>l.default.user.gem)return void h.default.show("\u94bb\u77f3\u4e0d\u8db3");l.default.user.gem-=r}return d.default.Instance().playSFX("flower_pot_land"),this.docomp(null),i.setItemData(l.default.user.BuyPlant(i.index,t),e),this.updateBuyButton(),!0}return e<=2&&(h.default.show("\u4f4d\u7f6e\u4e0d\u591f\u5566\uff01"),this.GetGameObject("btn_delete").stopAllActions(),this.GetGameObject("btn_delete").opacity=255,this.GetGameObject("btn_delete").runAction(cc.sequence(cc.delayTime(2),cc.fadeTo(1,0)))),!1},e.prototype.mergetip=function(){if(this.touchendtime=s.default.getServerTime(),!this.bPauseAutoCom&&!this.bInAutoCom&&!this.bInAutoCom)for(var t=0;t<this.items.length;++t)if(this.items[t]&&this.items[t].datacopy)for(var e=t+1;e<this.items.length;++e)if(this.items[e]&&this.items[e].datacopy){if(this.bInAutoCom)return;if(this.items[t].datacopy.lv==this.items[e].datacopy.lv&&0==this.items[t].droptype&&0==this.items[e].droptype&&this.items[t].datacopy.lv<m.MAX_PLANT){var i=this.items[t].index,n=this.items[e].index;this.GetGameObject("guild_1").active=!0,this.GetGameObject("guild_1").zIndex=cc.macro.MAX_ZINDEX,this.GetGameObject("guild_1").stopAllActions();var o=this.GetGameObject("slots").children[i].position,r=this.GetGameObject("slots").children[n].position;return this.GetGameObject("guild_1").position=o,void this.GetGameObject("guild_1").runAction(cc.sequence(cc.moveTo(1,cc.v2(r.x,r.y)),cc.moveTo(.1,cc.v2(o.x,o.y))).repeatForever())}}},e.prototype.onBtnClicked=function(t,e){var i=t.target.name;switch(d.default.Instance().playSFX("click"),i){case"btn_setting":s.default.createUI("prefab/SettingUI");break;case"btn_buy":this.tryBuyPlant(null,0),this.GetGameObject("guild_0").active=!1,0==l.default.user.guideIndex&&(l.default.user.guideIndex++,l.default.save()),1==l.default.user.guideIndex&&this.mergetip();break;case"bt_fast_gen":s.default.createUI("prefab/AdLayer").then(function(t){t.getComponent(f.default).setType(f.EADLAYER.DROP_PLANT)});break;case"btn_angry":s.default.createUI("prefab/AdLayer").then(function(t){t.getComponent(f.default).setType(f.EADLAYER.DOUBLE_ATT)});break;case"btn_double_coin":s.default.createUI("prefab/AdLayer").then(function(t){t.getComponent(f.default).setType(f.EADLAYER.DOUBLE_INCOME)});break;case"bt_auto_merge":s.default.createUI("prefab/AdLayer").then(function(t){t.getComponent(f.default).setType(f.EADLAYER.AUTO_COM)});break;case"btn_shop":w.default.show();break;case"btn_delete":255==this.GetGameObject("btn_delete").opacity&&h.default.show("\u62d6\u52a8\u5230\u8fd9\u91cc\u5356\u51fa")}},e._instance=null,o([O(cc.Prefab)],e.prototype,"enemy_pre",void 0),o([O(cc.Prefab)],e.prototype,"pre_soldier",void 0),e=i=o([G],e)}(c.default);i.default=M,cc._RF.pop()},{"../../resources/prefab/AdLayer":"AdLayer","../../resources/prefab/Enemy":"Enemy","../../resources/prefab/LoseUI":"LoseUI","../../resources/prefab/OfflineAwardUI":"OfflineAwardUI","../../resources/prefab/ShopLayer":"ShopLayer","../../resources/prefab/VictoryUI":"VictoryUI","../framwork/BaseUI":"BaseUI","../framwork/MsgHints":"MsgHints","../manager/Data":"Data","../utils/AudioMgr":"AudioMgr","../utils/Utils":"Utils","./DB":"DB","./SlotItem":"SlotItem","./SoldierItem":"SoldierItem"}],ListItem:[function(t,e,i){"use strict";cc._RF.push(e,"66c9a84a69BcLUb4nTwbgy6","ListItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r,a=cc._decorator,c=a.ccclass,s=a.property,l=a.disallowMultiple,u=a.menu,p=a.executionOrder;(function(t){t[t.NONE=0]="NONE",t[t.TOGGLE=1]="TOGGLE",t[t.SWITCH=2]="SWITCH"})(r||(r={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.title=null,e.selectedMode=r.NONE,e.selectedFlag=null,e.selectedSpriteFrame=null,e._unselectedSpriteFrame=null,e._selected=!1,e._eventReg=!1,e}return n(e,t),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},set:function(t){if(this._selected=t,this.selectedFlag)switch(this.selectedMode){case r.TOGGLE:this.selectedFlag.active=t;break;case r.SWITCH:var e=this.selectedFlag.getComponent(cc.Sprite);e&&(e.spriteFrame=t?this.selectedSpriteFrame:this._unselectedSpriteFrame)}},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){if(this._btnCom=this.node.getComponent(cc.Button),this._btnCom||(this.selectedMode,r.NONE),this.selectedMode==r.SWITCH){var t=this.selectedFlag.getComponent(cc.Sprite);this._unselectedSpriteFrame=t.spriteFrame}},e.prototype._registerEvent=function(){if(this._btnCom&&this.list.selectedMode>0&&!this._eventReg){var t=new cc.Component.EventHandler;t.target=this.node,t.component="ListItem",t.handler="onClickThis",this._btnCom.clickEvents.unshift(t),this._eventReg=!0}},e.prototype.showAni=function(t,e,i){var n,o=this;switch(t){case 0:n=[cc.scaleTo(.2,.7),cc.moveBy(.3,0,2*this.node.height)];break;case 1:n=[cc.scaleTo(.2,.7),cc.moveBy(.3,2*this.node.width,0)];break;case 2:n=[cc.scaleTo(.2,.7),cc.moveBy(.3,0,-2*this.node.height)];break;case 3:n=[cc.scaleTo(.2,.7),cc.moveBy(.3,-2*this.node.width,0)];break;default:n=[cc.scaleTo(.3,.1)]}(e||i)&&n.push(cc.callFunc(function(){if(i){o.list._delSingleItem(o.node);for(var t=o.list.displayData.length-1;t>=0;t--)if(o.list.displayData[t].id==o.listId){o.list.displayData.splice(t,1);break}}e()})),this.node.runAction(cc.sequence(n))},e.prototype.onClickThis=function(){this.list.selectedId=this.listId},o([s({type:cc.Sprite,tooltip:!1})],e.prototype,"icon",void 0),o([s({type:cc.Node,tooltip:!1})],e.prototype,"title",void 0),o([s({type:cc.Enum(r),tooltip:!1})],e.prototype,"selectedMode",void 0),o([s({type:cc.Node,tooltip:!1,visible:function(){return this.selectedMode>r.NONE}})],e.prototype,"selectedFlag",void 0),o([s({type:cc.SpriteFrame,tooltip:!1,visible:function(){return this.selectedMode==r.SWITCH}})],e.prototype,"selectedSpriteFrame",void 0),e=o([c,l(),u("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List Item"),p(-5001)],e)}(cc.Component);i.default=h,cc._RF.pop()},{}],List:[function(t,e,i){"use strict";cc._RF.push(e,"747f8Ttu9JGQrJfzFDk8XpT","List");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r,a,c,s=cc._decorator,l=s.ccclass,u=s.property,p=s.disallowMultiple,h=s.menu,d=s.executionOrder,f=t("./ListItem");(function(t){t[t.NODE=1]="NODE",t[t.PREFAB=2]="PREFAB"})(r||(r={})),function(t){t[t.NORMAL=1]="NORMAL",t[t.ADHERING=2]="ADHERING",t[t.PAGE=3]="PAGE"}(a||(a={})),function(t){t[t.NONE=0]="NONE",t[t.SINGLE=1]="SINGLE",t[t.MULT=2]="MULT"}(c||(c={}));var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateType=r.NODE,e.tmpNode=null,e.tmpPrefab=null,e._slideMode=a.NORMAL,e.pageDistance=.3,e.pageChangeEvent=new cc.Component.EventHandler,e._virtual=!0,e.lackCenter=!1,e._updateRate=2,e.frameByFrameRenderNum=0,e.renderEvent=new cc.Component.EventHandler,e.selectedMode=c.NONE,e.selectedEvent=null,e._selectedId=-1,e._forceUpdate=!1,e._updateDone=!0,e._numItems=0,e._inited=!1,e._aniDelRuning=!1,e._doneAfterUpdate=!1,e.adhering=!1,e._adheringBarrier=!1,e.curPageNum=0,e}return n(e,t),Object.defineProperty(e.prototype,"slideModel",{get:function(){return this._slideMode},set:function(t){this._slideMode=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"virtual",{get:function(){return this._virtual},set:function(t){null!=t&&(this._virtual=t),0!=this._numItems&&this._onScrolling(null)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updateRate",{get:function(){return this._updateRate},set:function(t){t>=0&&t<=6&&(this._updateRate=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedId",{get:function(){return this._selectedId},set:function(t){var e,i=this;if(i.selectedMode!=c.SINGLE||t!=i._selectedId)switch(i.selectedMode){case c.SINGLE:if(t==i._selectedId)return;if(!(e=i.getItemByListId(t))&&t>=0)return;var n=void 0;if(i._selectedId>=0?i._lastSelectedId=i._selectedId:i._lastSelectedId=null,i._selectedId=t,e&&((n=e.getComponent(f.default)).selected=!0),i._lastSelectedId>=0){var o=i.getItemByListId(i._lastSelectedId);o&&(o.getComponent(f.default).selected=!1)}i.selectedEvent&&cc.Component.EventHandler.emitEvents([i.selectedEvent],e,t,i._lastSelectedId);break;case c.MULT:if(!(e=i.getItemByListId(t)))return;n=e.getComponent(f.default);i._selectedId>=0&&(i._lastSelectedId=i._selectedId),i._selectedId=t;var r=!n.selected;n.selected=r;var a=i.multSelected.indexOf(t);r&&a<0?i.multSelected.push(t):!r&&a>=0&&i.multSelected.splice(a,1),i.selectedEvent&&cc.Component.EventHandler.emitEvents([i.selectedEvent],e,t,i._lastSelectedId,r)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numItems",{get:function(){return this._numItems},set:function(t){var e=this;if(e.checkInited(!1))if(null==t||t<0)cc.error("numItems set the wrong::",t);else if(e._numItems=t,e._forceUpdate=!0,e._virtual)e._resizeContent(),e._onScrolling(null);else{var i=e.content.getComponent(cc.Layout);if(i&&(i.enabled=!0),e._delRedundantItem(),e.firstListId=0,e.frameByFrameRenderNum>0){for(var n=e.frameByFrameRenderNum>e._numItems?e._numItems:e.frameByFrameRenderNum,o=0;o<n;o++)e._createOrUpdateItem2(o);e.frameByFrameRenderNum<e._numItems&&(e._updateCounter=e.frameByFrameRenderNum,e._updateDone=!1)}else{for(o=0;o<t;o++)e._createOrUpdateItem2(o);e.actualNumItems=t}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollView",{get:function(){return this._scrollView},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){this._init()},e.prototype.start=function(){this._init()},e.prototype.onEnable=function(){this._registerEvent(),this._init()},e.prototype.onDisable=function(){this._unregisterEvent()},e.prototype._registerEvent=function(){var t=this;t.node.on("touch-up",t._onScrollTouchUp,t),t.node.on("scroll-began",t._onScrollBegan,t,!0),t.node.on("scroll-ended",t._onScrollEnded,t,!0),t.node.on("scrolling",t._onScrolling,t,!0)},e.prototype._unregisterEvent=function(){var t=this;t.node.off("touch-up",t._onScrollTouchUp,t),t.node.off("scroll-began",t._onScrollBegan,t,!0),t.node.off("scroll-ended",t._onScrollEnded,t,!0),t.node.off("scrolling",t._onScrolling,t,!0)},e.prototype._init=function(){var t=this;if(!t._inited)if(t._scrollView=t.node.getComponent(cc.ScrollView),t._scrollView)if(t.content=t._scrollView.content,t.content){switch(t._layout=t.content.getComponent(cc.Layout),t._align=t._layout.type,t._resizeMode=t._layout.resizeMode,t._startAxis=t._layout.startAxis,t._topGap=t._layout.paddingTop,t._rightGap=t._layout.paddingRight,t._bottomGap=t._layout.paddingBottom,t._leftGap=t._layout.paddingLeft,t._columnGap=t._layout.spacingX,t._lineGap=t._layout.spacingY,t._colLineNum,t._verticalDir=t._layout.verticalDirection,t._horizontalDir=t._layout.horizontalDirection,t.setTemplateItem(t.templateType==r.PREFAB?t.tmpPrefab.data:t.tmpNode),t._slideMode!=a.ADHERING&&t._slideMode!=a.PAGE||(t._scrollView.inertia=!1),t.virtual||(t.lackCenter=!1),t._lastDisplayData=[],t.displayData=[],t._pool=new cc.NodePool,t._forceUpdate=!1,t._updateCounter=0,t._updateDone=!0,t._align){case cc.Layout.Type.HORIZONTAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}break;case cc.Layout.Type.VERTICAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.Type.GRID:switch(t._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.AxisDirection.VERTICAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}}}t.content.removeAllChildren(),t._inited=!0}else cc.error(t.node.name+"'s cc.ScrollView unset content!");else cc.error(t.node.name+" no assembly cc.ScrollView!")},e.prototype.setTemplateItem=function(t){if(t){var e=this;switch(e._itemTmp=t,e._resizeMode==cc.Layout.ResizeMode.CHILDREN?e._itemSize=e._layout.cellSize:e._itemSize=cc.size(e._itemTmp.width,e._itemTmp.height),e.selectedMode==c.MULT&&(e.multSelected=[]),e._align){case cc.Layout.Type.HORIZONTAL:e._colLineNum=1,e._sizeType=!1;break;case cc.Layout.Type.VERTICAL:e._colLineNum=1,e._sizeType=!0;break;case cc.Layout.Type.GRID:switch(e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var i=e.content.width-e._leftGap-e._rightGap;for(e._colLineNum=1;;){if(i-(e._colLineNum*e._itemSize.width+(e._colLineNum-1)*e._columnGap)<0){e._colLineNum--;break}e._colLineNum++}e._sizeType=!0;break;case cc.Layout.AxisDirection.VERTICAL:var n=e.content.height-e._topGap-e._bottomGap;for(e._colLineNum=1;;){if(n-(e._colLineNum*e._itemSize.height+(e._colLineNum-1)*e._lineGap)<0){e._colLineNum--;break}e._colLineNum++}e._sizeType=!1}}}},e.prototype.checkInited=function(t){var e=t||!0;return!!this._inited||(e&&cc.error("List initialization not completed!"),!1)},e.prototype._resizeContent=function(){var t,e=this;switch(e._align){case cc.Layout.Type.HORIZONTAL:if(e.customSize){var i=e._getFixedSize(null);t=e._leftGap+i.val+e._itemSize.width*(e._numItems-i.count)+e._columnGap*(e._numItems-1)+e._rightGap}else t=e._leftGap+e._itemSize.width*e._numItems+e._columnGap*(e._numItems-1)+e._rightGap;break;case cc.Layout.Type.VERTICAL:if(e.customSize){i=e._getFixedSize(null);t=e._topGap+i.val+e._itemSize.height*(e._numItems-i.count)+e._lineGap*(e._numItems-1)+e._bottomGap}else t=e._topGap+e._itemSize.height*e._numItems+e._lineGap*(e._numItems-1)+e._bottomGap;break;case cc.Layout.Type.GRID:switch(e.lackCenter&&(e.lackCenter=!1),e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var n=Math.ceil(e._numItems/e._colLineNum);t=e._topGap+e._itemSize.height*n+e._lineGap*(n-1)+e._bottomGap;break;case cc.Layout.AxisDirection.VERTICAL:var o=Math.ceil(e._numItems/e._colLineNum);t=e._leftGap+e._itemSize.width*o+e._columnGap*(o-1)+e._rightGap}}var r,a=e.content.getComponent(cc.Layout);a&&(a.enabled=!1),e._allItemSize=t,e._sizeType?((r=t<e.node.height?e.node.height-.1:t)<0&&(r=0),e._lackSize=e.lackCenter?r:null,e._allItemSizeNoBorder=e._allItemSize-e._topGap-e._bottomGap,e.content.height=r):((r=t<e.node.width?e.node.width-.1:t)<0&&(r=0),e._lackSize=e.lackCenter?r:null,e._allItemSizeNoBorder=e._allItemSize-e._leftGap-e._rightGap,e.content.width=r)},e.prototype._onScrolling=function(t){if(null==this.frameCount&&(this.frameCount=this._updateRate),!this._forceUpdate&&t&&"scroll-ended"!=t.type&&this.frameCount>0)this.frameCount--;else if(this.frameCount=this._updateRate,!this._aniDelRuning&&(this._calcViewPos(),this._virtual)){this.displayData=[];var e=void 0,i=0,n=this._numItems-1;if(this.customSize)for(var o=!1;i<=n&&!o;i++)switch(e=this._calcItemPos(i),this._align){case cc.Layout.Type.HORIZONTAL:e.right>=this.viewLeft&&e.left<=this.viewRight?this.displayData.push(e):0!=i&&this.displayData.length>0&&(o=!0);break;case cc.Layout.Type.VERTICAL:e.bottom<=this.viewTop&&e.top>=this.viewBottom?this.displayData.push(e):0!=i&&this.displayData.length>0&&(o=!0);break;case cc.Layout.Type.GRID:switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:e.bottom<=this.viewTop&&e.top>=this.viewBottom?this.displayData.push(e):0!=i&&this.displayData.length>0&&(o=!0);break;case cc.Layout.AxisDirection.VERTICAL:e.right>=this.viewLeft&&e.left<=this.viewRight?this.displayData.push(e):0!=i&&this.displayData.length>0&&(o=!0)}}else{var r=this._itemSize.width+this._columnGap,a=this._itemSize.height+this._lineGap;switch(this._alignCalcType){case 1:i=(this.viewLeft+this._leftGap)/r,n=(this.viewRight+this._rightGap)/r;break;case 2:i=(-this.viewRight-this._rightGap)/r,n=(-this.viewLeft-this._leftGap)/r;break;case 3:i=(-this.viewTop-this._topGap)/a,n=(-this.viewBottom-this._bottomGap)/a;break;case 4:i=(this.viewBottom+this._bottomGap)/a,n=(this.viewTop+this._topGap)/a}for(i=Math.floor(i)*this._colLineNum,n=Math.ceil(n)*this._colLineNum,n--,i<0&&(i=0),n>=this._numItems&&(n=this._numItems-1);i<=n;i++)this.displayData.push(this._calcItemPos(i))}if(this.displayData.length<=0||!this._numItems)return void this._delRedundantItem();this.firstListId=this.displayData[0].id,this.actualNumItems=this.displayData.length;var c=this._lastDisplayData.length;if(this._forceUpdate||this.actualNumItems!=c||this.firstListId!=this._lastDisplayData[0]||this.displayData[this.actualNumItems-1].id!=this._lastDisplayData[c-1])if(this._lastDisplayData=[],this.frameByFrameRenderNum>0)this._numItems>0?(this._updateDone?this._updateCounter=0:this._doneAfterUpdate=!0,this._updateDone=!1):(this._delRedundantItem(),this._updateCounter=0,this._updateDone=!0);else{for(var s=0;s<this.actualNumItems;s++)this._createOrUpdateItem(this.displayData[s]);this._delRedundantItem(),this._forceUpdate=!1}this._calcNearestItem()}},e.prototype._calcViewPos=function(){var t=this.content.getPosition();switch(this._alignCalcType){case 1:this.elasticLeft=t.x>0?t.x:0,this.viewLeft=(t.x<0?-t.x:0)-this.elasticLeft,this.viewRight=this.viewLeft+this.node.width,this.elasticRight=this.viewRight>this.content.width?Math.abs(this.viewRight-this.content.width):0,this.viewRight+=this.elasticRight;break;case 2:this.elasticRight=t.x<0?-t.x:0,this.viewRight=(t.x>0?-t.x:0)+this.elasticRight,this.viewLeft=this.viewRight-this.node.width,this.elasticLeft=this.viewLeft<-this.content.width?Math.abs(this.viewLeft+this.content.width):0,this.viewLeft-=this.elasticLeft;break;case 3:this.elasticTop=t.y<0?Math.abs(t.y):0,this.viewTop=(t.y>0?-t.y:0)+this.elasticTop,this.viewBottom=this.viewTop-this.node.height,this.elasticBottom=this.viewBottom<-this.content.height?Math.abs(this.viewBottom+this.content.height):0,this.viewBottom+=this.elasticBottom;break;case 4:this.elasticBottom=t.y>0?Math.abs(t.y):0,this.viewBottom=(t.y<0?-t.y:0)-this.elasticBottom,this.viewTop=this.viewBottom+this.node.height,this.elasticTop=this.viewTop>this.content.height?Math.abs(this.viewTop-this.content.height):0,this.viewTop-=this.elasticTop}},e.prototype._calcItemPos=function(t){var e,i,n,o,r,a,c,s;switch(this._align){case cc.Layout.Type.HORIZONTAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:if(this.customSize){var l=this._getFixedSize(t);r=this._leftGap+(this._itemSize.width+this._columnGap)*(t-l.count)+(l.val+this._columnGap*l.count),e=(u=this.customSize[t])>0?u:this._itemSize.width}else r=this._leftGap+(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width;if(a=r+e,this.lackCenter&&this._lackSize>=0)r+=p=this.content.width/2-this._allItemSizeNoBorder/2,a+=p;return{id:t,left:r,right:a,x:r+this._itemTmp.anchorX*e,y:this._itemTmp.y};case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:if(this.customSize){l=this._getFixedSize(t);a=-this._rightGap-(this._itemSize.width+this._columnGap)*(t-l.count)-(l.val+this._columnGap*l.count),e=(u=this.customSize[t])>0?u:this._itemSize.width}else a=-this._rightGap-(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width;if(r=a-e,this.lackCenter&&this._lackSize>=0)r-=p=this.content.width/2-this._allItemSizeNoBorder/2,a-=p;return{id:t,right:a,left:r,x:r+this._itemTmp.anchorX*e,y:this._itemTmp.y}}break;case cc.Layout.Type.VERTICAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:if(this.customSize){l=this._getFixedSize(t);n=-this._topGap-(this._itemSize.height+this._lineGap)*(t-l.count)-(l.val+this._lineGap*l.count),i=(u=this.customSize[t])>0?u:this._itemSize.height}else n=-this._topGap-(this._itemSize.height+this._lineGap)*t,i=this._itemSize.height;if(o=n-i,this.lackCenter&&this._lackSize>=0)n-=p=this.content.height/2-this._allItemSizeNoBorder/2,o-=p;return{id:t,top:n,bottom:o,x:this._itemTmp.x,y:o+this._itemTmp.anchorY*i};case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:if(this.customSize){var u;l=this._getFixedSize(t);o=this._bottomGap+(this._itemSize.height+this._lineGap)*(t-l.count)+(l.val+this._lineGap*l.count),i=(u=this.customSize[t])>0?u:this._itemSize.height}else o=this._bottomGap+(this._itemSize.height+this._lineGap)*t,i=this._itemSize.height;var p;if(n=o+i,this.lackCenter&&this._lackSize>=0)n+=p=this.content.height/2-this._allItemSizeNoBorder/2,o+=p;return{id:t,top:n,bottom:o,x:this._itemTmp.x,y:o+this._itemTmp.anchorY*i}}case cc.Layout.Type.GRID:var h=Math.floor(t/this._colLineNum);switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:s=(o=(n=-this._topGap-(this._itemSize.height+this._lineGap)*h)-this._itemSize.height)+this._itemTmp.anchorY*this._itemSize.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:n=(o=this._bottomGap+(this._itemSize.height+this._lineGap)*h)+this._itemSize.height,s=o+this._itemTmp.anchorY*this._itemSize.height}switch(c=this._leftGap+t%this._colLineNum*(this._itemSize.width+this._columnGap),this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:c+=this._itemTmp.anchorX*this._itemSize.width,c-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:c+=(1-this._itemTmp.anchorX)*this._itemSize.width,c-=(1-this.content.anchorX)*this.content.width,c*=-1}return{id:t,top:n,bottom:o,x:c,y:s};case cc.Layout.AxisDirection.VERTICAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:a=(r=this._leftGap+(this._itemSize.width+this._columnGap)*h)+this._itemSize.width,c=r+this._itemTmp.anchorX*this._itemSize.width,c-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:c=(r=(a=-this._rightGap-(this._itemSize.width+this._columnGap)*h)-this._itemSize.width)+this._itemTmp.anchorX*this._itemSize.width,c+=(1-this.content.anchorX)*this.content.width}switch(s=-this._topGap-t%this._colLineNum*(this._itemSize.height+this._lineGap),this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:s-=(1-this._itemTmp.anchorY)*this._itemSize.height,s+=(1-this.content.anchorY)*this.content.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:s-=this._itemTmp.anchorY*this._itemSize.height,s+=this.content.anchorY*this.content.height,s*=-1}return{id:t,left:r,right:a,x:c,y:s}}}},e.prototype._getFixedSize=function(t){if(!this.customSize)return null;null==t&&(t=this._numItems);var e=0,i=0;for(var n in this.customSize)parseInt(n)<t&&(e+=this.customSize[n],i++);return{val:e,count:i}},e.prototype._onScrollBegan=function(){this._beganPos=this._sizeType?this.viewTop:this.viewLeft},e.prototype._onScrollEnded=function(){var t=this;if(null!=t.scrollToListId){var e=t.getItemByListId(t.scrollToListId);t.scrollToListId=null,e&&e.runAction(cc.sequence(cc.scaleTo(.1,1.06),cc.scaleTo(.1,1)))}t._onScrolling(null),t._slideMode!=a.ADHERING||t.adhering?t._slideMode==a.PAGE&&(null!=t._beganPos?this._pageAdhere():t.adhere()):t.adhere()},e.prototype._onScrollTouchUp=function(){var t=this;t._scrollPos=null,t._slideMode==a.ADHERING?(this.adhering&&(this._adheringBarrier=!0),t.adhere()):t._slideMode==a.PAGE&&(null!=t._beganPos?this._pageAdhere():t.adhere())},e.prototype._pageAdhere=function(){var t=this;if(!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){var e=t._sizeType?t.viewTop:t.viewLeft,i=(t._sizeType?t.node.height:t.node.width)*t.pageDistance;if(Math.abs(t._beganPos-e)>i){switch(t._alignCalcType){case 1:case 4:t._beganPos>e?t.prePage(.5):t.nextPage(.5);break;case 2:case 3:t._beganPos<e?t.prePage(.5):t.nextPage(.5)}}else t.elasticTop<=0&&t.elasticRight<=0&&t.elasticBottom<=0&&t.elasticLeft<=0&&t.adhere();t._beganPos=null}},e.prototype.adhere=function(){var t=this;if(!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){t.adhering=!0,t._calcNearestItem();var e=(t._sizeType?t._topGap:t._leftGap)/(t._sizeType?t.node.height:t.node.width);t.scrollTo(t.nearestListId,.7,e)}},e.prototype.update=function(t){if(!(this.frameByFrameRenderNum<=0||this._updateDone))if(this._virtual){for(var e=this._updateCounter+this.frameByFrameRenderNum>this.actualNumItems?this.actualNumItems:this._updateCounter+this.frameByFrameRenderNum,i=this._updateCounter;i<e;i++){var n=this.displayData[i];n&&this._createOrUpdateItem(n)}this._updateCounter>=this.actualNumItems-1?this._doneAfterUpdate?(this._updateCounter=0,this._updateDone=!1,this._scrollView.isScrolling()||(this._doneAfterUpdate=!1)):(this._updateDone=!0,this._delRedundantItem(),this._forceUpdate=!1,this._calcNearestItem()):this._updateCounter+=this.frameByFrameRenderNum}else if(this._updateCounter<this._numItems){for(e=this._updateCounter+this.frameByFrameRenderNum>this._numItems?this._numItems:this._updateCounter+this.frameByFrameRenderNum,i=this._updateCounter;i<e;i++)this._createOrUpdateItem2(i);this._updateCounter+=this.frameByFrameRenderNum}else this._updateDone=!0,this._calcNearestItem()},e.prototype._createOrUpdateItem=function(t){var e,i=this.getItemByListId(t.id);i?this._forceUpdate&&this.renderEvent&&(i.setPosition(cc.v2(t.x,t.y)),this._resetItemSize(i),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],i,t.id)):((i=this._pool.size()?this._pool.get():cc.instantiate(this._itemTmp)).setPosition(cc.v2(t.x,t.y)),this._resetItemSize(i),this.content.addChild(i),i.setSiblingIndex(this.content.childrenCount-1),(e=i.getComponent(f.default)).listId=t.id,e.list=this,e._registerEvent(),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],i,t.id)),this._resetItemSize(i),this._updateListItem(e),this._lastDisplayData.indexOf(t.id)<0&&this._lastDisplayData.push(t.id)},e.prototype._createOrUpdateItem2=function(t){var e,i=this.content.children[t];i?this._forceUpdate&&this.renderEvent&&((e=i.getComponent(f.default)).listId=t,this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],i,t)):(i=cc.instantiate(this._itemTmp),this.content.addChild(i),(e=i.getComponent(f.default)).listId=t,e.list=this,e._registerEvent(),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],i,t)),this._updateListItem(e),this._lastDisplayData.indexOf(t)<0&&this._lastDisplayData.push(t)},e.prototype._updateListItem=function(t){if(t&&this.selectedMode>c.NONE)switch(this.selectedMode){case c.SINGLE:t.selected=this.selectedId==t.listId;break;case c.MULT:t.selected=this.multSelected.indexOf(t.listId)>=0}},e.prototype._resetItemSize=function(t){var e=t.getComponent(f.default);if(this.customSize&&this.customSize[e.listId]){var i=this.customSize[e.listId];this._align==cc.Layout.Type.HORIZONTAL?t.width=i:this._align==cc.Layout.Type.VERTICAL&&(t.height=i)}else t.setContentSize(this._itemSize)},e.prototype.setMultSelected=function(t,e){var i=this;if(Array.isArray(t)||(t=[t]),null==e)i.multSelected=null,i.multSelected=t;else{var n=void 0,o=void 0;if(e)for(var r=t.length-1;r>=0;r--)n=t[r],(o=i.multSelected.indexOf(n))<0&&i.multSelected.push(n);else for(r=t.length-1;r>=0;r--)n=t[r],(o=i.multSelected.indexOf(n))>=0&&i.multSelected.splice(o,1)}i._forceUpdate=!0,i._onScrolling(null)},e.prototype.updateAppointed=function(t){Array.isArray(t)||(t=[t]);for(var e=t.length,i=0;i<e;i++){var n=t[i],o=this.getItemByListId(n);o&&cc.Component.EventHandler.emitEvents([this.renderEvent],o,n)}},e.prototype.getItemByListId=function(t){for(var e=this.content.childrenCount-1;e>=0;e--)if(this.content.children[e].getComponent(f.default).listId==t)return this.content.children[e];return null},e.prototype._getOutsideItem=function(){for(var t,e,i=[],n=this.content.childrenCount-1;n>=0;n--){if(t=this.content.children[n],e=!0)for(var o=this.actualNumItems-1;o>=0;o--)if(this.displayData[o]){var r=this.displayData[o].id;if(t.getComponent(f.default).listId==r){e=!1;break}}e&&i.push(t)}return i},e.prototype._delRedundantItem=function(){if(this._virtual)for(var t=this._getOutsideItem(),e=t.length-1;e>=0;e--)this._pool.put(t[e]);else for(;this.content.childrenCount>this._numItems;)this._delSingleItem(this.content.children[this.content.childrenCount-1])},e.prototype._delSingleItem=function(t){t.removeFromParent(),t.destroy&&t.destroy(),t=null},e.prototype.aniDelItem=function(t,e,i){var n,o=this,r=o.getItemByListId(t);if(!o._aniDelRuning&&o._virtual)if(r){n=r.getComponent(f.default),o._aniDelRuning=!0;var a=o.displayData[o.displayData.length-1].id,s=n.selected;n.showAni(i,function(){var i;if(a<o._numItems-2&&(i=a+1),null!=i){var n=o._calcItemPos(i);o.displayData.push(n),o._virtual?o._createOrUpdateItem(n):o._createOrUpdateItem2(i)}else o._numItems--;if(o.selectedMode==c.SINGLE)s?o._selectedId=-1:o._selectedId-1>=0&&o._selectedId--;else if(o.selectedMode==c.MULT&&o.multSelected.length){var l=o.multSelected.indexOf(t);l>=0&&o.multSelected.splice(l,1);for(var u=o.multSelected.length-1;u>=0;u--){(d=o.multSelected[u])>=t&&o.multSelected[u]--}}if(o.customSize){o.customSize[t]&&delete o.customSize[t];var p={},h=void 0;for(var d in o.customSize){h=o.customSize[d];var f=parseInt(d);p[f-(f>=t?1:0)]=h}o.customSize=p}var _,m;for(u=null!=i?i:a;u>=t+1;u--)if(r=o.getItemByListId(u)){var y=o._calcItemPos(u-1);_=[cc.moveTo(.2333,cc.v2(y.x,y.y))],u<=t+1&&(m=!0,_.push(cc.callFunc(function(){o._aniDelRuning=!1,e(t)}))),_.length>1?r.runAction(cc.sequence(_)):r.runAction(_[0])}m||(o._aniDelRuning=!1,e(t))},!0)}else e(t)},e.prototype.scrollTo=function(t,e,i,n){void 0===e&&(e=.5),void 0===i&&(i=null),void 0===n&&(n=!1);var o=this;if(o.checkInited(!1)){o._scrollView.stopAutoScroll(),null==e?e=.5:e<0&&(e=0),t<0?t=0:t>=o._numItems&&(t=o._numItems-1);var r,a,c=o._calcItemPos(t);switch(o._alignCalcType){case 1:r=c.left,r-=null!=i?o.node.width*i:o._leftGap,c=cc.v2(r,0);break;case 2:r=c.right-o.node.width,r+=null!=i?o.node.width*i:o._rightGap,c=cc.v2(r+o.content.width,0);break;case 3:a=c.top,a+=null!=i?o.node.height*i:o._topGap,c=cc.v2(0,-a);break;case 4:a=c.bottom+o.node.height,a-=null!=i?o.node.height*i:o._bottomGap,c=cc.v2(0,-a+o.content.height)}var s=o.content.getPosition();s=Math.abs(o._sizeType?s.y:s.x);var l=o._sizeType?c.y:c.x,u=Math.abs((null!=o._scrollPos?o._scrollPos:s)-l)>.5;o._scrollView.stopAutoScroll(),u&&(o._scrollView.scrollToOffset(c,e),o.scheduleOnce(function(){if(o._adheringBarrier||(o.adhering=o._adheringBarrier=!1),n){var e=o.getItemByListId(t);e&&e.runAction(cc.sequence(cc.scaleTo(.1,1.05),cc.scaleTo(.1,1)))}},e+.1),e<=0&&o._onScrolling(null))}},e.prototype._calcNearestItem=function(){var t,e;this.nearestListId=null,this._virtual&&this._calcViewPos();for(var i=!1,n=0;n<this.content.childrenCount&&!i;n+=this._colLineNum)switch(t=this._virtual?this.displayData[n]:this._calcExistItemPos(n),e=this._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,this._alignCalcType){case 1:t.right>=this.viewLeft&&(this.nearestListId=t.id,this.viewLeft>e&&(this.nearestListId+=this._colLineNum),i=!0);break;case 2:t.left<=this.viewRight&&(this.nearestListId=t.id,this.viewRight<e&&(this.nearestListId+=this._colLineNum),i=!0);break;case 3:t.bottom<=this.viewTop&&(this.nearestListId=t.id,this.viewTop<e&&(this.nearestListId+=this._colLineNum),i=!0);break;case 4:t.top>=this.viewBottom&&(this.nearestListId=t.id,this.viewBottom>e&&(this.nearestListId+=this._colLineNum),i=!0)}if((t=this._virtual?this.displayData[this.actualNumItems-1]:this._calcExistItemPos(this._numItems-1))&&t.id==this._numItems-1)switch(e=this._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,this._alignCalcType){case 1:this.viewRight>e&&(this.nearestListId=t.id);break;case 2:this.viewLeft<e&&(this.nearestListId=t.id);break;case 3:this.viewBottom<e&&(this.nearestListId=t.id);break;case 4:this.viewTop>e&&(this.nearestListId=t.id)}},e.prototype._calcExistItemPos=function(t){var e=this.getItemByListId(t);if(!e)return null;var i={id:t,x:e.x,y:e.y};return this._sizeType?(i.top=e.y+e.height*(1-e.anchorY),i.bottom=e.y-e.height*e.anchorY):(i.left=e.x-e.width*e.anchorX,i.right=e.x+e.width*(1-e.anchorX)),i},e.prototype.prePage=function(t){void 0===t&&(t=.5),this.skipPage(this.curPageNum-1,t)},e.prototype.nextPage=function(t){void 0===t&&(t=.5),this.skipPage(this.curPageNum+1,t)},e.prototype.skipPage=function(t,e){var i=this;if(i._slideMode!=a.PAGE)return cc.error("This function is not allowed to be called, Must SlideMode = PAGE!");t<0||t>=i._numItems||i.curPageNum!=t&&(i.curPageNum=t,i.pageChangeEvent&&cc.Component.EventHandler.emitEvents([i.pageChangeEvent],t),i.scrollTo(t,e))},e.prototype.calcCustomSize=function(t){var e=this;if(!e._itemTmp)return cc.error("Unset template item!");if(!e.renderEvent)return cc.error("Unset Render-Event!");e.customSize={};var i=cc.instantiate(e._itemTmp);e.content.addChild(i);for(var n=0;n<t;n++)cc.Component.EventHandler.emitEvents([e.renderEvent],i,n),i.height==e._itemSize.height&&i.width==e._itemSize.width||(e.customSize[n]=e._sizeType?i.height:i.width);return Object.keys(e.customSize).length||(e.customSize=null),i.removeFromParent(),i.destroy&&i.destroy(),e.customSize},o([u({type:cc.Enum(r),tooltip:!1})],e.prototype,"templateType",void 0),o([u({type:cc.Node,tooltip:!1,visible:function(){return this.templateType==r.NODE}})],e.prototype,"tmpNode",void 0),o([u({type:cc.Prefab,tooltip:!1,visible:function(){return this.templateType==r.PREFAB}})],e.prototype,"tmpPrefab",void 0),o([u()],e.prototype,"_slideMode",void 0),o([u({type:cc.Enum(a),tooltip:!1})],e.prototype,"slideModel",null),o([u({type:cc.Float,range:[0,1,.1],tooltip:!1,slide:!0,visible:function(){return this._slideMode==a.PAGE}})],e.prototype,"pageDistance",void 0),o([u({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this._slideMode==a.PAGE}})],e.prototype,"pageChangeEvent",void 0),o([u()],e.prototype,"_virtual",void 0),o([u({type:cc.Boolean,tooltip:!1})],e.prototype,"virtual",null),o([u({tooltip:!1,visible:function(){return this.virtual}})],e.prototype,"lackCenter",void 0),o([u({type:cc.Integer})],e.prototype,"_updateRate",void 0),o([u({type:cc.Integer,range:[0,6,1],tooltip:!1,slide:!0})],e.prototype,"updateRate",null),o([u({type:cc.Integer,range:[0,12,1],tooltip:!1,slide:!0})],e.prototype,"frameByFrameRenderNum",void 0),o([u({type:cc.Component.EventHandler,tooltip:!1})],e.prototype,"renderEvent",void 0),o([u({type:cc.Enum(c),tooltip:!1})],e.prototype,"selectedMode",void 0),o([u({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this.selectedMode>c.NONE}})],e.prototype,"selectedEvent",void 0),o([u({serializable:!1})],e.prototype,"_numItems",void 0),e=o([l,p(),h("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List"),d(-5e3)],e)}(cc.Component);i.default=_,cc._RF.pop()},{"./ListItem":"ListItem"}],Loading:[function(t,e,i){"use strict";cc._RF.push(e,"af4a3CKKPZAwr4aagW/gTcl","Loading");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function a(t){try{s(n.next(t))}catch(t){r(t)}}function c(t){try{s(n.throw(t))}catch(t){r(t)}}function s(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(a,c)}s((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var c=t("../../script/manager/ConfigManager"),s=t("../../script/utils/AudioMgr"),l=t("../../script/framwork/BaseUI"),u=t("../../script/manager/Data"),p=t("../../script/manager/PoolMgr"),h=cc._decorator,d=h.ccclass,f=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.progress=0,e}return n(e,t),e.prototype.onBtnClicked=function(t,e){switch(t.target.name){case"btn_rstart":cc.director.loadScene("loading")}},e.prototype.loadSubpackage=function(t){var e=this;return new Promise(function(i,n){cc.loader.downloader.loadSubpackage(t,function(t){t?(console.error(t),cc.isValid(e.node)&&(e.GetGameObject("btn_rstart").active=!0),n()):(cc.isValid(e.node)&&e.SetProgressBar("ProgressBar",e.GetProgressBar("ProgressBar").progress+.2),i(null))})})},e.prototype.onLoad=function(){return r(this,void 0,void 0,function(){var e,i,n,o=this;return a(this,function(r){switch(r.label){case 0:return cc.debug.setDisplayStats(!1),cc.game.setFrameRate(60),(e=cc.sys.localStorage.getItem("savedatatime"))&&(e=Number(e)),t.prototype.onLoad.call(this),[4,c.default.Instance().loadConfig()];case 1:return r.sent(),this.startLoginAction(),i=["\u521d\u6b21\u52a0\u8f7d\u65f6\u95f4\u53ef\u80fd\u4f1a\u8f83\u957f\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85....","\u6709\u4e00\u5929\uff0c\u82b1\u6735\u738b\u56fd\u91cc\u6765\u4e86\u4e00\u7fa4\u50f5\u5c38...","\u82b1\u56ed\u4fdd\u536b\u6218\u5373\u5c06\u6253\u54cd\uff0c\u5feb\u53bb\u5e2e\u52a9\u82b1\u6735\u4eec\u62b5\u5fa1\u5165\u4fb5\uff01"],n=0,this.node.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){o.SetText("desp",i[n]),++n>i.length-1&&(n=0)})).repeatForever()),this.GetGameObject("btn_rstart").active=!1,[2]}})})},e.prototype.startLoginAction=function(){var t=this;s.default.Instance().loadSounds(),this.node.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){return r(t,void 0,void 0,function(){var t,e=this;return a(this,function(i){return u.default.loadData(),t=0,this.node.runAction(cc.sequence(cc.delayTime(.01),cc.callFunc(function(){t+=.018,e.SetProgressBar("ProgressBar",t),t>=1&&(e.node.stopAllActions(),p.default.Instance().loadPrefabs(),cc.director.loadScene("hall"))})).repeatForever()),[2]})})})))},e.prototype.subpackagecomplete=function(){return r(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,c.default.Instance().loadConfig()];case 1:return t.sent(),this.startLoginAction(),[2]}})})},e.prototype.start=function(){window.btn_event&&window.btn_event("start","\u5f00\u59cb")},e=o([d],e)}(l.default));i.default=f,cc._RF.pop()},{"../../script/framwork/BaseUI":"BaseUI","../../script/manager/ConfigManager":"ConfigManager","../../script/manager/Data":"Data","../../script/manager/PoolMgr":"PoolMgr","../../script/utils/AudioMgr":"AudioMgr"}],LongTouchComponent:[function(t,e,i){"use strict";cc._RF.push(e,"e00b9OAUdVJhbS0BUI7M5px","LongTouchComponent");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,c=r.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.touchInterval=.02,e.enableMultiTouching=!1,e.longTouchEvents=[],e._touchCounter=0,e._isTouching=!1,e}return n(e,t),e.prototype.onEnable=function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this)},e.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this),this.unschedule(this._touchCounterCallback)},e.prototype.clear=function(){this._isTouching=!1,this.unschedule(this._touchCounterCallback)},e.prototype._onTouchStart=function(t){var e=this;if(!this.enableMultiTouching){if(this._isTouching)return;this.node.getBoundingBoxToWorld().contains(t.getLocation())?this._isTouching=!0:this._isTouching=!1,this._isTouching&&(this.publishOneTouch(),this.node.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){e._isTouching&&(e.unschedule(e._touchCounterCallback),e.schedule(e._touchCounterCallback,e.touchInterval))}))))}},e.prototype._onTouchEnd=function(t){this._isTouching=!1,this._touchCounter=0,this.unschedule(this._touchCounterCallback)},e.prototype._onTouchCancel=function(t){this._isTouching=!1,this._touchCounter=0,this.unschedule(this._touchCounterCallback)},e.prototype._touchCounterCallback=function(){this._isTouching?this.publishOneTouch():this.unschedule(this._touchCounterCallback)},e.prototype.publishOneTouch=function(){var t=this;this._isTouching&&(this.node.runAction(cc.sequence(cc.scaleTo(this.touchInterval/2,1.2),cc.scaleTo(this.touchInterval/2,1))),this._touchCounter++,this.longTouchEvents.forEach(function(e){e.emit([t.node])}))},o([c({tooltip:"\u89e6\u6478\u56de\u8c03\u95f4\u9694\uff08\u79d2\uff09\u3002\u5047\u5982\u4e3a0.1\uff0c\u90a3\u4e481\u79d2\u5185\u4f1a\u56de\u8c0310\u6b21 ${longTouchEvents} \u4e8b\u4ef6\u6570\u7ec4"})],e.prototype,"touchInterval",void 0),o([c({readonly:!0,tooltip:"\u662f\u5426\u652f\u6301\u591a\u70b9\u89e6\u63a7\uff08\u5f53\u524d\u8fd8\u4e0d\u652f\u6301\uff09"})],e.prototype,"enableMultiTouching",void 0),o([c({type:[cc.Component.EventHandler],tooltip:"\u56de\u8c03\u4e8b\u4ef6\u6570\u7ec4\uff0c\u6bcf\u95f4\u9694 ${toucheInterval}s \u56de\u8c03\u4e00\u6b21"})],e.prototype,"longTouchEvents",void 0),e=o([a],e)}(cc.Component);i.default=s,cc._RF.pop()},{}],LoseUI:[function(t,e,i){"use strict";cc._RF.push(e,"824b0PiTCRL9oHjDzaJijvV","LoseUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../script/framwork/BaseUI"),a=t("../../script/utils/Utils"),c=t("../../script/manager/Data"),s=t("../../script/utils/AudioMgr"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.coin=0,e}return n(e,t),e.prototype.start=function(){var t=this;this.GetGameObject("lbl_coin").opacity=0,this.GetGameObject("lbl_coin").runAction(cc.sequence(cc.delayTime(.5),cc.fadeTo(1,255))),this.GetGameObject("btn_get").active=!1,s.default.Instance().playSFX("fail");var e=5;this.node.runAction(cc.sequence(cc.callFunc(function(){t.GetGameObject("btn_get").active=e<=4,t.SetText("lbl_time",a.default.getTimeStrByS(e)),e<0&&t.closeUI(),e--}),cc.delayTime(1)).repeat(7))},e.prototype.setInfo=function(t){this.coin=t,this.SetText("lbl_coin",a.default.formatNumber(t))},e.prototype.closeUI=function(){var t=this.coin;s.default.Instance().playSFX("coin"),a.default.flyAnim(0,this.node,"icon_coin",a.default.getRandomInt(5,10),100,function(e){e&&(c.default.user.coin+=Math.floor(t/2))}),this.shutAnim()},e.prototype.onBtnClicked=function(t,e){var i=t.target.name;switch(s.default.Instance().playSFX("click"),i){case"btn_get":this.closeUI()}},e=o([u],e)}(r.default));i.default=p,cc._RF.pop()},{"../../script/framwork/BaseUI":"BaseUI","../../script/manager/Data":"Data","../../script/utils/AudioMgr":"AudioMgr","../../script/utils/Utils":"Utils"}],MsgHints:[function(t,e,i){"use strict";cc._RF.push(e,"922a144cLRCbrDv5hv5JyP8","MsgHints");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../manager/PoolMgr"),a=cc._decorator,c=a.ccclass,s=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var i;return n(e,t),i=e,e.show=function(t){if(""!=t)if(null!=i._prefab){if(0!=r.default.Instance().pools.msg_hints.size()){var e=r.default.Instance().get("msg_hints");e.scaleY=0,e.parent=cc.find("Canvas"),e.zIndex=999999999,e.getChildByName("label").getComponent(cc.Label).string=t,e.getComponent(cc.Animation).play("msghints",0),e.getComponent(cc.Animation).on("finished",function(){r.default.Instance().put("msg_hints",e)})}}else cc.loader.loadRes("prefab/common/msg_hints",function(e,n){e||(i._prefab=n,r.default.Instance().initPool("msg_hints",i._prefab,20),i.show(t))})},e._prefab=null,e=i=o([c],e)}(cc.Component));i.default=s,cc._RF.pop()},{"../manager/PoolMgr":"PoolMgr"}],NewPlantUI:[function(t,e,i){"use strict";cc._RF.push(e,"46e3e5iTx5BT7fDRmzqw2qW","NewPlantUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function a(t){try{s(n.next(t))}catch(t){r(t)}}function c(t){try{s(n.throw(t))}catch(t){r(t)}}function s(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(a,c)}s((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var c=t("../../script/framwork/BaseUI"),s=t("../../script/manager/Data"),l=t("../../script/game/DB"),u=t("../../script/utils/Utils"),p=t("../../script/utils/AudioMgr"),h=cc._decorator,d=h.ccclass,f=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.coin=0,e.gem=0,e}return n(e,t),e.prototype.start=function(){return r(this,void 0,void 0,function(){var t,e,i,n;return a(this,function(o){switch(o.label){case 0:return t=s.default.user.GetMaxLv(),e=s.default.user.BuyPrice(Math.max(1,t-3)),i=l.DB_levelupGem[t+""],this.GetGameObject("node_gem").active=i,this.SetText("lbl_lv","\u7b49\u7ea7"+t),p.default.Instance().playSFX("unlock_plant"),this.coin=e,i&&(this.gem=i[1],this.SetText("lbl_gem",this.gem+"")),this.SetText("lbl_coin",u.default.formatNumber(e)),n=this.GetSkeleton("flower1"),[4,u.default.loadRes("spine/flower"+t,sp.SkeletonData)];case 1:return n.skeletonData=o.sent(),this.GetSkeleton("flower1").setAnimation(0,"idleL",!0),[2]}})})},e.prototype.onBtnClicked=function(t,e){var i=t.target.name;switch(p.default.Instance().playSFX("click"),i){case"btn_get":var n=this.coin,o=this.gem;p.default.Instance().playSFX("coin"),u.default.flyAnim(0,this.node,"icon_coin",u.default.getRandomInt(5,10),100,function(t){t&&(s.default.user.coin+=Math.floor(n/2))}),o>0&&(p.default.Instance().playSFX("gem"),u.default.flyAnim(1,this.node,"icon_gem",u.default.getRandomInt(2,4),85,function(t){t&&(s.default.user.gem+=o)})),this.closeUI()}},e=o([d],e)}(c.default));i.default=f,cc._RF.pop()},{"../../script/framwork/BaseUI":"BaseUI","../../script/game/DB":"DB","../../script/manager/Data":"Data","../../script/utils/AudioMgr":"AudioMgr","../../script/utils/Utils":"Utils"}],NumberRoll:[function(t,e,i){"use strict";cc._RF.push(e,"7afd2vdphtCjKWi+cfBvmoW","NumberRoll");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../framwork/BaseUI"),a=cc._decorator,c=a.ccclass,s=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._cur=0,e._target=0,e._offset=0,e}return n(e,t),e.prototype.start=function(){this.label=this.node.getComponent(cc.Label)},Object.defineProperty(e.prototype,"vaule",{set:function(t){this._target=t,this._offset=Math.floor((this._target-this._cur)/Math.min(30,Math.abs(this._target-this._cur)))},enumerable:!0,configurable:!0}),e.prototype.update=function(t){1/t<cc.game.getFrameRate()/2?this.label.string=this._target+"":(this._cur!=this._target&&(this._cur+=this._offset,this._offset>0&&this._cur>this._target&&(this._cur=this._target),this._offset<0&&this._cur<this._target&&(this._cur=this._target)),this.label.string=this._cur+"")},e=o([c],e)}(r.default));i.default=s,cc._RF.pop()},{"../framwork/BaseUI":"BaseUI"}],OfflineAwardUI:[function(t,e,i){"use strict";cc._RF.push(e,"47509lvN65A3YtUxhS8R3fU","OfflineAwardUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../script/framwork/BaseUI"),a=t("../../script/utils/AudioMgr"),c=t("../../script/utils/BigNumber"),s=t("../../script/utils/Utils"),l=t("../../script/manager/Data"),u=t("../../script/framwork/MsgHints"),p=cc._decorator,h=p.ccclass,d=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._data=0,e}return n(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,this.GetText("lbl_coin").string=c.default.getLargeString(s.default.fixFloat(t))},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.node.zIndex=99999},e.prototype.onBtnClicked=function(t,e){var i=this;switch(t.target.name){case"btn_close":a.default.Instance().playSFX("click");var n=this._data;a.default.Instance().playSFX("coin"),s.default.flyAnim(0,this.node,"icon_coin",s.default.getRandomInt(5,10),100,function(t){t&&(l.default.user.coin+=Math.floor(n/2))}),this.closeUI();break;case"btn_ad":window.videoPlayEnd=function(){i._data;a.default.Instance().playSFX("coin"),s.default.flyAnim(0,i.node,"icon_coin",s.default.getRandomInt(5,10),100,function(t){}),i.closeUI()},window.playVideoAd();break;case"btn_gem":if(l.default.user.gem<5)return void u.default.show("\u94bb\u77f3\u4e0d\u8db3");var o=3*this._data;a.default.Instance().playSFX("coin"),s.default.flyAnim(0,this.node,"icon_coin",s.default.getRandomInt(5,10),100,function(t){t&&(l.default.user.coin+=Math.floor(o/2),l.default.user.gem-=5)}),this.closeUI()}},e=o([h],e)}(r.default));i.default=d,cc._RF.pop()},{"../../script/framwork/BaseUI":"BaseUI","../../script/framwork/MsgHints":"MsgHints","../../script/manager/Data":"Data","../../script/utils/AudioMgr":"AudioMgr","../../script/utils/BigNumber":"BigNumber","../../script/utils/Utils":"Utils"}],PoolMgr:[function(t,e,i){"use strict";cc._RF.push(e,"96c22QZQoJEzrsdfStlsM1E","PoolMgr");var n=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,r=o.ccclass,a=(o.property,function(){function t(){this.pools={},this.prefabs={},this.pre_bullets=[]}var e;return e=t,t.Instance=function(){return null==e._instance&&(e._instance=new e),e._instance},t.prototype.loadPrefabs=function(){var t=this;cc.loader.loadRes("prefab/Coin",cc.Prefab,function(e,i){e?console.error(e):t.initPool("Coin",i,11)}),cc.loader.loadRes("prefab/Gem",cc.Prefab,function(e,i){e?console.error(e):t.initPool("Gem",i,11)})},t.prototype.initPool=function(t,e,i){this.prefabs[t]=e,this.pools[t]=new cc.NodePool;for(var n=0;n<i;++n)this.pools[t].put(cc.instantiate(e))},t.prototype.get=function(t){if(null==this.pools[t])return cc.error("\u6ca1\u6709"+t),null;if(this.pools[t].size()>0){var e=this.pools[t].get(),i=e.getChildByName("spine");return i&&(i.getComponent(sp.Skeleton).paused=!1),e}return cc.instantiate(this.prefabs[t])},t.prototype.put=function(t,e){this.pools[t].put(e)},t._instance=null,t=e=n([r],t)}());i.default=a,cc._RF.pop()},{}],SettingUI:[function(t,e,i){"use strict";cc._RF.push(e,"a80eb23B/dO9568DxP6flX0","SettingUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function a(t){try{s(n.next(t))}catch(t){r(t)}}function c(t){try{s(n.throw(t))}catch(t){r(t)}}function s(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(a,c)}s((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var c=t("../../script/framwork/BaseUI"),s=t("../../script/utils/AudioMgr"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btn_music=null,e.btn_music_close=null,e.btn_sound=null,e.btn_sound_close=null,e}return n(e,t),e.prototype.start=function(){return r(this,void 0,void 0,function(){return a(this,function(t){return s.default.Instance().playSFX("ui_open_popup_1"),this.btn_music=this.GetGameObject("btn_music_on"),this.btn_music_close=this.GetGameObject("btn_music_off"),this.btn_sound=this.GetGameObject("btn_sound_on"),this.btn_sound_close=this.GetGameObject("btn_sound_off"),this.btn_music.active=1==s.default.Instance().bgmVolume,this.btn_music_close.active=0==s.default.Instance().bgmVolume,this.btn_sound.active=1==s.default.Instance().sfxVolume,this.btn_sound_close.active=0==s.default.Instance().sfxVolume,[2]})})},e.prototype.onBtnClicked=function(t,e){var i=t.target.name;switch(s.default.Instance().playSFX("click"),i){case"btn_back":this.closeUI();break;case"btn_music_on":case"btn_music_off":this.btn_music.active=!this.btn_music.active,this.btn_music_close.active=!this.btn_music_close.active,s.default.Instance().setBGMVolume(this.btn_music.active?1:0,!0);break;case"btn_sound_on":case"btn_sound_off":this.btn_sound.active=!this.btn_sound.active,this.btn_sound_close.active=!this.btn_sound_close.active,s.default.Instance().setSFXVolume(this.btn_sound.active?1:0,!0)}},e=o([u],e)}(c.default));i.default=p,cc._RF.pop()},{"../../script/framwork/BaseUI":"BaseUI","../../script/utils/AudioMgr":"AudioMgr"}],Shake:[function(t,e,i){"use strict";cc._RF.push(e,"776856yN0hDUJ9tpRE0AmLJ","Shake");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,c=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._initial_x=0,e._initial_y=0,e._strength_x=0,e._strength_y=0,e}var i;return n(e,t),i=e,e.create=function(t,e,n){var o=new i;return o.initWithDuration(t,e,n),o},e.prototype.initWithDuration=function(t,e,i){return cc.ActionInterval.prototype.initWithDuration.apply(this,arguments),this._strength_x=e,this._strength_y=i,!0},e.prototype.fgRangeRand=function(t,e){return Math.random()*(e-t)+t},e.prototype.update=function(t){var e=this.fgRangeRand(-this._strength_x,this._strength_x),i=this.fgRangeRand(-this._strength_y,this._strength_y);this.getTarget().setPosition(e+this._initial_x,i+this._initial_y)},e.prototype.startWithTarget=function(t){cc.ActionInterval.prototype.startWithTarget.apply(this,arguments),this._initial_x=t.x,this._initial_y=t.y},e.prototype.stop=function(){this.getTarget().setPosition(new cc.Vec2(this._initial_x,this._initial_y)),cc.ActionInterval.prototype.stop.apply(this)},e=i=o([a],e)}(cc.ActionInterval));i.Shake=c,cc._RF.pop()},{}],ShopItem:[function(t,e,i){"use strict";cc._RF.push(e,"e6b02e+8pRDZ6todV8KUlNR","ShopItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function a(t){try{s(n.next(t))}catch(t){r(t)}}function c(t){try{s(n.throw(t))}catch(t){r(t)}}function s(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(a,c)}s((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var c,s=t("../../script/framwork/BaseUI"),l=t("../../script/utils/AudioMgr"),u=t("../../script/manager/Data"),p=t("../../script/utils/Utils"),h=t("../../script/framwork/MsgHints"),d=t("../../script/game/HallScene"),f=t("../../script/game/GameConst"),_=t("../../script/framwork/ListItem"),m=t("../../script/game/DB"),y=cc._decorator,v=y.ccclass;y.property;(function(t){t[t.CAN_BUY=1]="CAN_BUY",t[t.CAN_AD_BUY=2]="CAN_AD_BUY",t[t.ONLY_CHECK=4]="ONLY_CHECK",t[t.GEM_BUY=16]="GEM_BUY"})(c||(c={}));var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cost_coin=0,e.cost_gem=0,e.gun=null,e}return n(e,t),e.prototype.WatchAdBuy=function(t){var e=u.default.user.GetMaxLv();return!(e<8)&&e-4==t},e.prototype.OnlyCheck=function(t){var e=u.default.user.GetMaxLv();return e-2<=t&&t<=e},e.prototype.BuyGem=function(t){return u.default.user.GetMaxLv()-1==t},e.prototype.getBuyType=function(t){var e=u.default.user.GetMaxLv(),i=0;return t[0]<=e-2&&(i|=c.CAN_BUY),this.WatchAdBuy(t[0])&&(i|=c.CAN_AD_BUY),this.BuyGem(t[0])&&(i|=c.GEM_BUY),this.OnlyCheck(t[0])&&(i|=c.ONLY_CHECK),i},e.prototype.setItemData=function(t){return r(this,void 0,void 0,function(){var e,i,n,o,r,s,l,h,d,f,_;return a(this,function(a){switch(a.label){case 0:return e=null,i=!1,n=this.getBuyType(t),this.gun=t,this.GetGameObject("show").active=!1,this.GetGameObject("hide").active=!1,this.GetGameObject("btn_gem").active=!1,this.GetGameObject("btn_yellow").active=!1,this.GetGameObject("btn_free").active=!1,this.GetGameObject("btn_gray").active=!1,this.cost_gem=Math.min(t[6],5),0!=(n&c.GEM_BUY)&&t[6]>0?(this.GetGameObject("show").active=!0,this.GetGameObject("btn_gem").active=!0,e=this.GetGameObject("show")):0!=(n&c.CAN_AD_BUY)?(this.GetGameObject("show").active=!0,this.GetGameObject("btn_free").active=!0,e=this.GetGameObject("show")):0!=(n&c.CAN_BUY)?(this.GetGameObject("show").active=!0,this.GetGameObject("btn_yellow").active=!0,e=this.GetGameObject("show")):0!=(n&c.ONLY_CHECK)?(this.GetGameObject("show").active=!0,this.GetGameObject("btn_gray").active=!0,e=this.GetGameObject("show")):(this.GetGameObject("hide").active=!0,e=this.GetGameObject("hide"),i=!0),this._findInChildren(e,"lbl_lv").getComponent(cc.Label).string=""+t[0],this._findInChildren(e,"New Label").getComponent(cc.Label).string=""+(t[0]+2),o=t[3].split("|"),r=o[0],s=o[1],l="",i&&(s="?"),1==r?l="\u6280\u80fd:"+s+"%\u7684\u51e0\u7387\u89e6\u53d1\u51cf\u901f\u76ee\u68071\u79d2":2==r?l="\u6280\u80fd:"+s+"%\u51e0\u7387\u5bf9\u76ee\u6807\u9020\u6210\u53cc\u500d\u4f24\u5bb3":3==r&&(l="\u6280\u80fd:"+s+"%\u51e0\u7387\u51b0\u51bb\u76ee\u68071\u79d2"),this._findInChildren(e,"lbl_name").getComponent(cc.Label).string=l,this._findInChildren(e,"lbl_cd").getComponent(cc.Label).string=i?"?":t[1]+"",this._findInChildren(e,"lbl_power").getComponent(cc.Label).string=i?"?":p.default.formatNumber(t[2])+"",h=this._findInChildren(e,"gun").getComponent(cc.Sprite),[4,p.default.loadRes("texture/plants/"+(t[0]-1),cc.SpriteFrame)];case 1:return h.spriteFrame=a.sent(),d=this._findInChildren(e,"gun").getComponent(cc.Sprite),[4,p.default.loadRes("texture/plants/"+(t[0]-1),cc.SpriteFrame)];case 2:return d.spriteFrame=a.sent(),t[0]+1<m.MAX_PLANT?(f=this._findInChildren(e,"0").getComponent(cc.Sprite),[4,p.default.loadRes("texture/plants/"+(t[0]+1),cc.SpriteFrame)]):[3,4];case 3:return f.spriteFrame=a.sent(),[3,6];case 4:return _=this._findInChildren(e,"0").getComponent(cc.Sprite),[4,p.default.loadRes("texture/plants/"+(m.MAX_PLANT-1),cc.SpriteFrame)];case 5:_.spriteFrame=a.sent(),a.label=6;case 6:return this.cost_coin=u.default.user.BuyPrice(t[0]),this.SetText("lbl_buy_coin",p.default.formatNumber(this.cost_coin)),this.GetButton("btn_yellow").interactable=u.default.user.coin>=this.cost_coin,this.SetText("lbl_buy_gem",p.default.formatNumber(this.cost_gem)),[2]}})})},e.prototype.onBtnClicked=function(e,i){var n=this;t.prototype.onBtnClicked.call(this,e,i);var o=e.target.name;switch(l.default.Instance().playSFX("click"),o){case"btn_free":window.videoPlayEnd=function(){h.default.show("\u8d2d\u4e70\u6210\u529f"),d.default.Instance.tryBuyPlant(n.gun[0],3)&&(h.default.show("\u8d2d\u4e70\u6210\u529f"),n.dispatch(f.default.BUY_PLANT,n.gun,n.node.getComponent(_.default).listId))},window.playVideoAd();break;case"btn_yellow":if(u.default.user.coin<this.cost_coin)return void h.default.show("\u91d1\u5e01\u4e0d\u8db3");d.default.Instance.tryBuyPlant(this.gun[0],0)&&(h.default.show("\u8d2d\u4e70\u6210\u529f"),this.dispatch(f.default.BUY_PLANT,this.gun,this.node.getComponent(_.default).listId));break;case"btn_gem":if(u.default.user.gem<this.cost_gem)return void h.default.show("\u94bb\u77f3\u4e0d\u8db3");d.default.Instance.tryBuyPlant(this.gun[0],1)&&(h.default.show("\u8d2d\u4e70\u6210\u529f"),this.dispatch(f.default.BUY_PLANT,this.gun,this.node.getComponent(_.default).listId))}},e=o([v],e)}(s.default);i.default=g,cc._RF.pop()},{"../../script/framwork/BaseUI":"BaseUI","../../script/framwork/ListItem":"ListItem","../../script/framwork/MsgHints":"MsgHints","../../script/game/DB":"DB","../../script/game/GameConst":"GameConst","../../script/game/HallScene":"HallScene","../../script/manager/Data":"Data","../../script/utils/AudioMgr":"AudioMgr","../../script/utils/Utils":"Utils"}],ShopLayer:[function(t,e,i){"use strict";cc._RF.push(e,"97852ZxHcBIu6WWaQlOhdZh","ShopLayer");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../script/framwork/BaseUI"),a=t("../../script/framwork/List"),c=t("./ShopItem"),s=t("../../script/game/DB"),l=t("../../script/game/GameConst"),u=t("../../script/manager/Data"),p=t("../../script/utils/Utils"),h=t("../../script/utils/AudioMgr"),d=cc._decorator,f=d.ccclass,_=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.list=null,e}var i;return n(e,t),i=e,e.show=function(){i._instance?(i._instance.active=!0,i._instance.getComponent(i).reLoad()):p.default.createUI("prefab/ShopLayer")},e.prototype.start=function(){var t=this;i._instance=this.node,this.list=s.DB_plant,this.reLoad(),this.rigester(l.default.BUY_PLANT,function(e,i){t.GetGameObject("ScrollView").getComponent(a.default).updateAppointed(i)}),this.rigester(l.default.NEW_PLANT,function(){t.reLoad()})},e.prototype.reLoad=function(){this.list=s.DB_plant,this.GetGameObject("ScrollView").getComponent(a.default).numItems=this.list.length;var t=Math.max(0,u.default.user.GetMaxLv()-5);this.GetGameObject("ScrollView").getComponent(a.default).scrollTo(t,.2)},e.prototype.onBtnClicked=function(t,e){h.default.Instance().playSFX("click"),this.node.active=!1},e.prototype.onListRender=function(t,e){t.getComponent(c.default).setItemData(this.list[e])},e._instance=null,e=i=o([f],e)}(r.default));i.default=_,cc._RF.pop()},{"../../script/framwork/BaseUI":"BaseUI","../../script/framwork/List":"List","../../script/game/DB":"DB","../../script/game/GameConst":"GameConst","../../script/manager/Data":"Data","../../script/utils/AudioMgr":"AudioMgr","../../script/utils/Utils":"Utils","./ShopItem":"ShopItem"}],Singleton:[function(t,e,i){"use strict";cc._RF.push(e,"b3524d7zH9PiqxWDRneLvf8","Singleton"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){}return t.Instance=function(){return this.instance||(this.instance=new this),this.instance},t}();i.default=n,cc._RF.pop()},{}],SlotItem:[function(t,e,i){"use strict";cc._RF.push(e,"8cf323gxb5C04zxaDSUVHAv","SlotItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../framwork/BaseUI"),a=t("../manager/Data"),c=t("./DB"),s=t("../utils/Utils"),l=t("../framwork/MsgHints"),u=t("./GameConst"),p=cc._decorator,h=p.ccclass,d=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.index=0,e}var i;return n(e,t),i=e,e.getCurOpen=function(){for(var t=-1,e=1;e<12;++e)if(0==a.default.user.slots[e]){t=e;break}return t},e.prototype.onBtnClicked=function(t,e){var n=i.getCurOpen();if(-1!=n)if(this.index-1>n)l.default.show("\u9700\u8981\u5148\u89e3\u9501"+(n+1));else{var o=c.DB_slot[n].type;if(0==o){if(a.default.user.coin<c.DB_slot[n].price)return void l.default.show("\u91d1\u5e01\u4e0d\u8db3")}else if(a.default.user.gem<c.DB_slot[n].price)return void l.default.show("\u94bb\u77f3\u4e0d\u8db3");a.default.user.slots[n]=1,0==o?a.default.user.coin-=c.DB_slot[n].price:a.default.user.gem-=c.DB_slot[n].price,a.default.save(),this.dispatch(u.default.OPEN_SLOT,n),this.setIndex(this.index)}},e.prototype.setIndex=function(t){this.index=t,this.SetText("lbl_index",t+"");var e=i.getCurOpen();this.node.getComponent(cc.Button).interactable=this.index-1>=e&&-1!=e;var n=a.default.user.slots[t-1];this.GetGameObject("lock").active=0==n,this.GetGameObject("lbl_index").active=0==n,this.GetGameObject("node_cost").active=0==n,this.GetGameObject("2btcoin").active=0==c.DB_slot[t-1].type,this.GetGameObject("2btdiamond").active=1==c.DB_slot[t-1].type,this.SetText("lbl_open_cost",s.default.formatNumber(c.DB_slot[t-1].price))},e=i=o([h],e)}(r.default));i.default=d,cc._RF.pop()},{"../framwork/BaseUI":"BaseUI","../framwork/MsgHints":"MsgHints","../manager/Data":"Data","../utils/Utils":"Utils","./DB":"DB","./GameConst":"GameConst"}],SoldierItem:[function(t,e,i){"use strict";cc._RF.push(e,"58176B7xzJGVr/d2mUCbUBE","SoldierItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function a(t){try{s(n.next(t))}catch(t){r(t)}}function c(t){try{s(n.throw(t))}catch(t){r(t)}}function s(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(a,c)}s((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var c=t("../utils/Utils"),s=t("../framwork/BaseUI"),l=t("./DB"),u=t("./HallScene"),p=t("../../resources/prefab/Bullet"),h=t("../manager/Data"),d=cc._decorator,f=d.ccclass,_=(d.executeInEditMode,d.property),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bullet_pre=null,e.index=-1,e.linkItem=null,e.datacopy=null,e.bDrag=!1,e.droptype=0,e.droptype0endtime=0,e.curplayani="",e.cd=0,e.lastfire=0,e}return n(e,t),e.prototype.setItemData=function(t,e){void 0===e&&(e=-1),-1!=e&&(this.droptype=e),0!=this.droptype&&this.droptype0endtime<c.default.getServerTime()&&(this.droptype0endtime=c.default.getServerTime()+1e4),this.datacopy&&t&&this.datacopy.index==t.index&&this.datacopy.lv==t.lv&&this.datacopy.open==t.open||(this.datacopy=t?JSON.parse(JSON.stringify(t)):null,this.datacopy&&(this.datacopy.index=this.index),this.updateItem())},e.prototype.updateItem=function(){return r(this,void 0,void 0,function(){var t,e,i,n,o=this;return a(this,function(r){switch(r.label){case 0:return this.GetGameObject("level_1").active=null!=this.datacopy,this.GetGameObject("flower1").active=null!=this.datacopy,this.datacopy?(this.GetGameObject("lbl_lv").getComponent(cc.Label).string="lv."+this.datacopy.lv,0!=this.droptype?[3,3]:(this.GetGameObject("lbl_lv").active=!0,t=l.DB_plant[Math.min(this.datacopy.lv-1,l.MAX_PLANT-1)],this.cd=Number(t[1]),this.curplayani==this.datacopy.lv+"_idleL"?[3,2]:(this.curplayani=this.datacopy.lv+"_idleL",e=this.GetSkeleton("flower1"),[4,c.default.loadRes("spine/flower"+Math.min(this.datacopy.lv,l.MAX_PLANT),sp.SkeletonData)]))):[3,8];case 1:e.skeletonData=r.sent(),this.GetSkeleton("flower1").setAnimation(0,"idleL",!0),r.label=2;case 2:return[3,8];case 3:return this.GetGameObject("lbl_lv").active=!1,4!=this.droptype?[3,6]:"pot1_idle"==this.curplayani?[3,5]:(this.curplayani="pot1_idle",this.node.opacity=0,i=this.GetSkeleton("flower1"),[4,c.default.loadRes("spine/pot1",sp.SkeletonData)]);case 4:i.skeletonData=r.sent(),this.GetSkeleton("flower1").clearTracks(),this.GetSkeleton("flower1").setAnimation(0,"fall",!1),this.node.opacity=255,this.node.runAction(cc.sequence(cc.delayTime(.8),cc.callFunc(function(){o.GetSkeleton("flower1").setAnimation(1,"idle",!0)}))),r.label=5;case 5:return[3,8];case 6:return"pot3_idle"==this.curplayani?[3,8]:(this.curplayani="pot3_idle",this.node.opacity=0,n=this.GetSkeleton("flower1"),[4,c.default.loadRes("spine/pot3",sp.SkeletonData)]);case 7:n.skeletonData=r.sent(),this.GetSkeleton("flower1").clearTracks(),this.GetSkeleton("flower1").setAnimation(0,"fall",!1),this.node.opacity=255,this.node.runAction(cc.sequence(cc.delayTime(.8),cc.callFunc(function(){o.GetSkeleton("flower1").setAnimation(1,"idle",!0)}))),r.label=8;case 8:return[2]}})})},e.prototype.getTarget=function(){for(var t=u.default.Instance.enemylist,e=null,i=400,n=0;n<t.length;++n)if(!(t[n].x<-cc.winSize.width/2)){var o=t[n].position.sub(this.node.position).mag();o<i&&(e=t[n],i=o)}return e},e.prototype.update=function(t){var e=this;if(this.datacopy&&0==this.droptype&&h.default.user.double_att_time>c.default.getServerTime()?(this.GetSkeleton("flower1").timeScale=1.5,this.GetGameObject("kb").active=!0):(this.GetSkeleton("flower1").timeScale=1,this.GetGameObject("kb").active=!1),0!=this.droptype&&c.default.getServerTime()>this.droptype0endtime&&(this.droptype=0,this.updateItem()),!this.bDrag&&this.datacopy&&0==this.droptype&&(this.lastfire+=t,this.lastfire>=this.cd/(h.default.user.double_att_time>c.default.getServerTime()?2:1))){this.lastfire=0;var i=this.getTarget();i&&(this.node.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){if(!e.bDrag&&e.datacopy){var t=cc.instantiate(e.bullet_pre);t.position=e.node.position.add(i.x>e.node.x?cc.v3(15,35,0):cc.v3(-15,35,0)),t.parent=u.default.Instance.GetGameObject("node_bullet"),t.getComponent(p.default).setInfo(i,e.datacopy.lv)}}))),i.x>this.node.x?(this.GetSkeleton("flower1").setAnimation(0,"atkR",!1),this.GetSkeleton("flower1").setAnimation(1,"idleR",!0),this.curplayani="idleR"):(this.GetSkeleton("flower1").setAnimation(0,"atkL",!1),this.GetSkeleton("flower1").setAnimation(1,"idleL",!0),this.curplayani="idleL"))}},o([_(cc.Prefab)],e.prototype,"bullet_pre",void 0),e=o([f],e)}(s.default);i.default=m,cc._RF.pop()},{"../../resources/prefab/Bullet":"Bullet","../framwork/BaseUI":"BaseUI","../manager/Data":"Data","../utils/Utils":"Utils","./DB":"DB","./HallScene":"HallScene"}],UserModel:[function(t,e,i){"use strict";cc._RF.push(e,"e5755yzM1lE0roEui3wv0BT","UserModel");var n=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var o=t("../event/GameEvent"),r=t("../manager/Data"),a=t("../utils/Utils"),c=t("./GameConst"),s=t("./DB"),l=t("../utils/AudioMgr"),u=[];function p(t,e){u.push(e)}var h=cc._decorator,d=h.ccclass,f=(h.property,function(){function t(){this.nickName="",this.avatarUrl="",this.openid="",this.auto_com_time=0,this.double_att_time=0,this.double_income_time=0,this.drop_plant_time=0,this.slots=[1,1,1,1,1,0,0,0,0,0,0,0],this.lv=1,this.wave=1,this.DropGiftPts=[],this.AdBuyNotDrop=[],this._coin=1e3,this._gem=20,this._serverTime=0,this.guideIndex=0,this.plantBuyTimes={},this.todayComTimes=0,this.ComPlants=[{open:1,index:0,lv:1}]}return t.prototype.T=function(){for(var t=this.GetMaxLv(),e=s.DB_shopSort[t+""],i=1;i<=8;++i)if("AD"==e[i])return t-i;return t-4},t.prototype.getOfflineEarning=function(t){for(var e=null,i=[50,30,20,15,10,5,3,2],n=Math.max(1,this.T()),o=this.GetMaxLv(),r=Math.max(1,n-10);r<=n;++r){var a=this.BuyPrice(r);(!e||a>e)&&(e=a)}var c=e/3e3;c<1&&(c=1);var s=Math.floor(t/60),l=t%60/60,u=0;for(r=0;r<=s;++r){var p=i[r]||1;u+=r==s?c*(60*p)*(100*l)/100:c*(60*p)}for(var h=0,d=0,f=this.ComPlants;d<f.length;d++){var _=f[d],m=_.lv;if(_.lv>0)h+=1e4*u/(1e4*Math.pow(2.1,Math.max(0,o-m)))}return h},Object.defineProperty(t.prototype,"coin",{get:function(){return Math.floor(100*this._coin)/100},set:function(t){this._coin=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gem",{get:function(){return this._gem},set:function(t){this._gem=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverTime",{get:function(){return this._serverTime},set:function(t){this._serverTime=t},enumerable:!0,configurable:!0}),t.prototype.getPlantInfo=function(t){for(var e=0;e<this.ComPlants.length;++e)if(this.ComPlants[e].index==t)return this.ComPlants[e];return null},t.prototype.GetMaxLv=function(){for(var t=0,e=0;e<this.ComPlants.length;++e)this.ComPlants[e].lv>t&&(t=this.ComPlants[e].lv);return t},t.prototype.BuyPrice=function(t){var e=Number(s.DB_plant[t-1][5]),i=this.plantBuyTimes[t]||0;return 1==t?e*(1e4*Math.pow(1.07,i))/1e4:e*(1e4*Math.pow(1.175,i))/1e4},t.prototype.CompMove=function(t,e){var i=this.getPlantInfo(t),n=this.getPlantInfo(e);i&&n?(i.index=e,n.index=t):(i&&(i.index=e),n&&(n.index=t))},t.prototype.ComposePlant=function(t,e){var i=this.ComPlants.find(function(e){return e.index==t});if(!i)return!1;var n=this.ComPlants.find(function(t){return t.index==e});if(!n)return!1;if(i.lv!=n.lv)return console.error("err"),!1;for(var r=this.GetMaxLv(),u=this.getPlantInfo(t),p=u.lv,h=0;h<this.ComPlants.length;++h)if(this.ComPlants[h].index==t){this.ComPlants.splice(h,1);break}for(h=0;h<this.ComPlants.length;++h)if(this.ComPlants[h].index==e){this.ComPlants.splice(h,1);break}this.ComPlants.push({open:u.open,index:t,lv:p+1}),this.todayComTimes++;var d=this.GetMaxLv();return d>r&&d<s.MAX_PLANT&&(a.default.createUI("prefab/NewPlantUI"),o.default.Instance().dispatch(c.default.NEW_PLANT,d)),l.default.Instance().playSFX("merge_success"),!0},t.prototype.BuyPlant=function(t,e){if(this.plantBuyTimes[e]||(this.plantBuyTimes[e]=0),this.plantBuyTimes[e]++,!this.ComPlants.find(function(t){t.index})){var i={open:1,index:t,lv:e};return this.ComPlants.push(i),r.default.save(),i}console.error("\u7d22\u5f15\u9519\u8bef")},t.prototype.DropPlant=function(t){for(var e=0;e<this.ComPlants.length;++e)if(this.ComPlants[e].index==t){var i=this.BuyPrice(this.ComPlants[e].lv);r.default.user.coin+=Math.floor(i/2),cc.log("\u5356\u4e86\u6362\u94b1\uff1a"+i),this.ComPlants.splice(e,1);break}},t.prototype.getUploadData=function(){var t={};this.serverTime=a.default.getServerTime();for(var e=0;e<u.length;++e)t[u[e]]=this[u[e]];return t},t.prototype.setData=function(t){if(t)for(var e=0;e<u.length;++e){var i=t[u[e]];if(null!=i||void 0!=i)if("[object Object]"==Object.prototype.toString.call(i))for(var n in i)this[u[e]][n]=i[n];else this[u[e]]=i}},n([p],t.prototype,"nickName",void 0),n([p],t.prototype,"avatarUrl",void 0),n([p],t.prototype,"openid",void 0),n([p],t.prototype,"auto_com_time",void 0),n([p],t.prototype,"double_att_time",void 0),n([p],t.prototype,"double_income_time",void 0),n([p],t.prototype,"drop_plant_time",void 0),n([p],t.prototype,"slots",void 0),n([p],t.prototype,"lv",void 0),n([p],t.prototype,"wave",void 0),n([p],t.prototype,"DropGiftPts",void 0),n([p],t.prototype,"AdBuyNotDrop",void 0),n([p],t.prototype,"_coin",void 0),n([p],t.prototype,"_gem",void 0),n([p],t.prototype,"_serverTime",void 0),n([p],t.prototype,"guideIndex",void 0),n([p],t.prototype,"plantBuyTimes",void 0),n([p],t.prototype,"todayComTimes",void 0),n([p],t.prototype,"ComPlants",void 0),t=n([d],t)}());i.default=f,cc._RF.pop()},{"../event/GameEvent":"GameEvent","../manager/Data":"Data","../utils/AudioMgr":"AudioMgr","../utils/Utils":"Utils","./DB":"DB","./GameConst":"GameConst"}],Utils:[function(t,e,i){"use strict";cc._RF.push(e,"ff748PS7+hEIIiRCFvCwbSy","Utils"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("./Shake"),o=t("../framwork/BaseUI"),r=t("./BigNumber"),a=t("../manager/PoolMgr"),c=t("../game/HallScene");(function(t){t[t["\u91d1\u5e01"]=0]="\u91d1\u5e01",t[t["\u4f53\u529b"]=1]="\u4f53\u529b",t[t["\u94bb\u77f3"]=2]="\u94bb\u77f3"})(i.EFLY_TYPE||(i.EFLY_TYPE={}));var s=function(){function t(){}return t.createUI=function(t,e,i){return void 0===e&&(e=null),void 0===i&&(i=null),new Promise(function(n,o){cc.loader.loadRes(t,cc.Prefab,function(r,a){if(r)return console.error(r),void o();null==e&&(e=cc.find("Canvas"));var c=t.lastIndexOf("/"),s=t.substr(c+1,t.length-c);if(!e.getComponentInChildren(s)){var l=cc.instantiate(a);l.opacity=0,l.runAction(cc.sequence(cc.delayTime(.01),cc.callFunc(function(){l.opacity=255}))),l.parent=e,i&&i(l),n(l)}})})},t.createPrefab=function(t,e,i,n){return void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=null),new Promise(function(o,r){cc.loader.loadRes(t,cc.Prefab,function(t,a){if(t)return console.error(t),void r();null==e&&(e=cc.find("Canvas"));var c=cc.instantiate(a);c.opacity=0,c.runAction(cc.sequence(cc.delayTime(.01),cc.callFunc(function(){c.opacity=255}))),c.parent=e,n&&(c.position=n),i&&i(c),o(c)})})},t.closeAllUI=function(){for(var t=cc.find("Canvas"),e=0;e<t.childrenCount;++e){var i=t.children[e].getComponent(o.default);i&&i.closeUI()}},t.getRandom=function(t,e){return Math.random()*(e-t)+t},t.getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t))+t},t.seedRandomInt=function(e,i){return t.getRandomInt(e,i)},t.formatNumber=function(t,e){return void 0===e&&(e=1),t=Math.floor(t),r.default.getLargeString(t)},t.getPowNum=function(t){return Math.pow(10,t)},t.setServerTime=function(e){t.timeOffset=e-(new Date).getTime(),cc.log("timeOffset:",t.timeOffset)},t.getServerTime=function(){return(new Date).getTime()+t.timeOffset},t.Shake=function(t,e,i){var o=cc.find("Canvas/Main Camera");o.x=0,o.y=0,o.stopAllActions(),o.runAction(n.Shake.create(t,e,i))},t.addClickEvent=function(t,e,i,n,o){var r=new cc.Component.EventHandler;r.target=e,r.component=i,r.handler=n,o&&(r.customEventData=o);var a=t.getComponent(cc.Button).clickEvents;a.length>0?cc.warn("\u6309\u94ae\u5df2\u7ecf\u5b58\u5728\u7ed1\u5b9a\uff0c\u8df3\u8fc7\u81ea\u52a8\u7ed1\u5b9a",t.name):a.push(r)},t.getTimeStrByS=function(t){(t=Math.floor(t))<0&&(t=0);var e=Math.floor(t/3600/24);t-=3600*e*24;var i=Math.floor(t/3600);t-=3600*i;var n=Math.floor(t/60);t-=60*n;var o="00";o=i>9?""+i:"0"+i;var r="00";r=n>9?""+n:"0"+n;var a="00";return a=t>9?""+t:"0"+t,e>0?e+"\u5929"+i+"\u65f6"+n+"\u5206":i>0?o+":"+r:r+":"+a},t.formatCoin=function(t){return t=Math.floor(t),r.default.getLargeString(t)},t.loadRes=function(t,e){return new Promise(function(i,n){cc.loader.loadRes(t,e,function(e,o){e?(cc.error(t,e),n(null)):i(o)})})},t.weight=function(t){for(var e=0,i=0;i<t.length;++i)e+=t[i];if(e<=0)return-1;var n=Math.round(Math.random()*Number.MAX_VALUE)%e;for(i=0;i<t.length;++i){if(n<t[i])return i;n-=t[i]}return-1},t.fixFloat=function(t,e){void 0===e&&(e=2);var i=100*e;return Math.floor(t*i)/i},t.flyAnim=function(e,i,n,o,r,s){for(var l=function(t){return 0==t?a.default.Instance().get("Coin"):1==t?a.default.Instance().get("Gem"):void 0},u=i.parent.convertToWorldSpaceAR(i.position),p=function(t,e,i,n){for(var o=[],r=Math.PI/180*Math.round(360/n),a=0;a<n;a++){var c=e+t*Math.sin(r*a),s=i+t*Math.cos(r*a);o.unshift(cc.v2(c,s))}return o}(r,(u=cc.find("Canvas").convertToNodeSpaceAR(u)).x,u.y,o),h=new Array,d=0;d<p.length;d++){var f=l(e);f.parent=cc.find("Canvas");var _=cc.v2(p[d].x+t.getRandomInt(0,50),p[d].y+t.getRandomInt(0,50));f.setPosition(u),h.push({gold:f,randPos:_})}var m=!1,y=c.default.Instance.GetGameObject(n),v=y.parent.convertToWorldSpaceAR(y.position);v=cc.find("Canvas").convertToNodeSpaceAR(v);var g=y;for(d=0;d<h.length;d++){var b=h[d].randPos,w=h[d].gold;h[d].gold.id=d;var I=cc.sequence(cc.moveTo(.2,b),cc.delayTime(.03*d),cc.moveTo(.5,cc.v2(v.x,v.y)),cc.callFunc(function(t){if(!m){g.stopAllActions(),g.setScale(1),m=!0;var e=cc.sequence(cc.scaleTo(.1,2,2),cc.scaleTo(.1,1,1),cc.callFunc(function(){m=!1}));g.runAction(e)}s(t.id==h.length-1),a.default.Instance().put(t.name,t)}));w.runAction(I)}},t.timeOffset=0,t}();i.default=s,cc._RF.pop()},{"../framwork/BaseUI":"BaseUI","../game/HallScene":"HallScene","../manager/PoolMgr":"PoolMgr","./BigNumber":"BigNumber","./Shake":"Shake"}],VictoryUI:[function(t,e,i){"use strict";cc._RF.push(e,"bdcb9Wp8YxFErWZb5qYmaOU","VictoryUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(r<3?o(a):r>3?o(e,i,a):o(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../script/framwork/BaseUI"),a=t("../../script/manager/Data"),c=t("../../script/utils/AudioMgr"),s=t("../../script/utils/Utils"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.coin=0,e}return n(e,t),e.prototype.start=function(){var t=this;c.default.Instance().playSFX("win_stage"),this.GetSkeleton("fx_victory").setAnimation(0,"start",!1),this.GetSkeleton("fx_victory").setAnimation(1,"idle",!0),this.GetGameObject("btn_get").active=!1;var e=5;this.node.runAction(cc.sequence(cc.callFunc(function(){t.SetText("lbl_time",s.default.getTimeStrByS(e)),t.GetGameObject("btn_get").active=e<=4,e<0&&t.closeUI(),e--}),cc.delayTime(1)).repeat(7))},e.prototype.setInfo=function(t){this.coin=t,this.SetText("lbl_coin",s.default.formatNumber(t))},e.prototype.closeUI=function(){var t=this.coin;c.default.Instance().playSFX("coin"),s.default.flyAnim(0,this.node,"icon_coin",s.default.getRandomInt(5,10),100,function(e){e&&(a.default.user.coin+=Math.floor(t/2))}),this.shutAnim()},e.prototype.onBtnClicked=function(t,e){var i=t.target.name;switch(c.default.Instance().playSFX("click"),i){case"btn_get":this.closeUI()}},e=o([u],e)}(r.default));i.default=p,cc._RF.pop()},{"../../script/framwork/BaseUI":"BaseUI","../../script/manager/Data":"Data","../../script/utils/AudioMgr":"AudioMgr","../../script/utils/Utils":"Utils"}]},{},["Loading","AdLayer","BossCommingUI","Bullet","Enemy","FairyBonusUI","FairyItem","LoseUI","NewPlantUI","OfflineAwardUI","SettingUI","ShopItem","ShopLayer","VictoryUI","GameEvent","BaseUI","List","ListItem","MsgHints","DB","GameConst","HallScene","SlotItem","SoldierItem","UserModel","ConfigManager","Data","DataManager","PoolMgr","Singleton","AudioMgr","BigNumber","DebugTools","HTTP","LongTouchComponent","NumberRoll","Shake","Utils"]);