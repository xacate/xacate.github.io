"use strict";(self["webpackChunkadminback"]=self["webpackChunkadminback"]||[]).push([[356],{1356:function(e,t,l){l.r(t),l.d(t,{default:function(){return i}});var a=l(5918),o=l(6581),u=l(1969),d=l(3256),r=l(2472),c=(0,a.defineComponent)({__name:"UserView",setup(e){const t=(0,a.ref)(!1),l=(0,a.ref)(""),c=(0,a.ref)(""),n=async()=>{t.value=!0},i=async()=>{try{await o.i.passwordReset(l.value,c.value),t.value=!1,(0,d.T)("success")}catch(e){(0,d.Q)(e.message)}},s=(0,a.ref)(!1),V=(0,a.ref)(!1),m=(0,a.ref)(""),v=(0,a.ref)(""),h=(0,a.ref)(!1),f=async()=>{if(s.value)C();else try{const e=await o.i.certAuthCreate(l.value);console.log(e),o.i.downLoad(e,`${u.PD.userName}.cer`),(0,d.T)("success")}catch(e){(0,d.Q)(e.message)}},C=async()=>{try{const e=await o.i.googleAuthCreate(l.value);m.value=u.PD.decrypt(e),console.log(m.value),s.value=!1,V.value=!0}catch(e){}},w=async()=>{try{await o.i.googleAuthBind(u.PD.userName,v.value),V.value=!1,(0,d.T)("success")}catch(e){if(842===e.code)return void(N.value=!0);(0,d.Q)(e.message),console.log(e)}},N=(0,a.ref)(!1),p=async({raw:e})=>{try{const t=new FileReader;t.onload=function(){u.PD.privateKey=t.result,N.value=!1},t.readAsText(e)}catch(t){}};return(e,o)=>{const u=(0,a.resolveComponent)("el-button"),d=(0,a.resolveComponent)("el-card"),C=(0,a.resolveComponent)("el-input"),x=(0,a.resolveComponent)("el-form-item"),_=(0,a.resolveComponent)("el-form"),g=(0,a.resolveComponent)("el-dialog"),y=(0,a.resolveComponent)("el-upload");return(0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,[(0,a.createElementVNode)("div",null,[(0,a.createVNode)(d,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(u,{onClick:n},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)("修改密码")])),_:1}),(0,a.createVNode)(u,{onClick:o[0]||(o[0]=e=>h.value=!0)},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)("创建证书")])),_:1}),(0,a.createVNode)(u,{onClick:o[1]||(o[1]=e=>s.value=!0)},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)("重新绑定Google Auth")])),_:1})])),_:1})]),(0,a.createVNode)(g,{modelValue:t.value,"onUpdate:modelValue":o[4]||(o[4]=e=>t.value=e)},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(_,{"label-width":"150px"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(x,{label:"Google Auth Code:"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(C,{modelValue:l.value,"onUpdate:modelValue":o[2]||(o[2]=e=>l.value=e)},null,8,["modelValue"])])),_:1}),(0,a.createVNode)(x,{label:"New Password:"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(C,{type:"password",modelValue:c.value,"onUpdate:modelValue":o[3]||(o[3]=e=>c.value=e)},null,8,["modelValue"])])),_:1}),(0,a.createVNode)(x,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(u,{onClick:i},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)("修改密码")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.createVNode)(g,{modelValue:h.value||s.value,"onUpdate:modelValue":o[6]||(o[6]=e=>(h.value=!1,s.value=!1))},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(_,{"label-width":"150px"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(x,{label:"Google Auth Code:"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(C,{modelValue:l.value,"onUpdate:modelValue":o[5]||(o[5]=e=>l.value=e)},null,8,["modelValue"])])),_:1}),(0,a.createVNode)(x,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(u,{onClick:f},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(h.value?"创建证书":"重新绑定"),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.createVNode)(g,{modelValue:V.value,"onUpdate:modelValue":o[8]||(o[8]=e=>V.value=e)},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(_,{"label-width":"130px"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(x,{label:"扫一扫"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)((0,a.unref)(r.A),{value:m.value,width:200,height:200},null,8,["value"])])),_:1}),(0,a.createVNode)(x,{label:"Google Auth Code"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(C,{modelValue:v.value,"onUpdate:modelValue":o[7]||(o[7]=e=>v.value=e)},null,8,["modelValue"])])),_:1}),(0,a.createVNode)(x,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(u,{onClick:w},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)("确定")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.createVNode)(g,{modelValue:N.value,"onUpdate:modelValue":o[9]||(o[9]=e=>N.value=e)},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(_,{"label-width":"100px"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(x,{label:e.$t("permission.secret")},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(y,{action:"","on-change":p,"auto-upload":!1,limit:1},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(u,{size:"small",type:"primary"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("permission.upload")),1)])),_:1})])),_:1})])),_:1},8,["label"])])),_:1})])),_:1},8,["modelValue"])],64)}}});const n=c;var i=n}}]);