(self["webpackChunkadminback"]=self["webpackChunkadminback"]||[]).push([[454],{6581:function(e,t,s){"use strict";s.d(t,{i:function(){return m}});var _=s(1114),r=(s(4603),s(7566),s(8721),s(1969)),i=s(8935),n=s(803),o=s(3169),a=s.n(o),c=s(5662);function u(e){for(var t="",s=0;s<e.length-1;s+=2)t+=String.fromCharCode(parseInt(e.substr(s,2),16));return t}const d=e=>{try{let t=new c.RSAKey;t=c.KEYUTIL.getKey(r.PD.privateKey);const s=new c.KJUR.crypto.Signature({alg:"SHA1withRSA"});return s.init(t),s.updateString(e),c.hextob64(s.sign())}catch(t){console.log(t)}};class l{constructor(){(0,_.A)(this,"_host",""),(0,_.A)(this,"_isSecret",!0)}set host(e){this._host=e}login(e,t,s=""){const _=r.PD.getKeyToHex(),i={password:(0,r.YW)((0,r.YW)(t)),clientKey:_,authCode:s};return s&&(i["authCode"]=s),console.log(i),r.PD.clientKey=_,this._request(`/back/auth/signIn/${e}`,i).then((e=>(r.PD.clientKey=_,e)))}refreshToken(e){const t=r.PD.getKeyToHex(),s={refreshToken:r.PD.refresh,clientKey:t};return console.log(s),this._request(`/back/auth/signInRefresh/${e}`,s).then((e=>(r.PD.clientKey=t,e)))}googleAuthBind(e,t){return this._request(`/back/auth/googleAuthBind/${e}`,{authCode:t})}createApiPublic(){return i.service.get(`${this._host}/back/public?version=${r.XV}`,{},"text").then((e=>{if(200==e["code"])return e["data"];throw{code:-1,message:""}}))}googleAuthCreate(e){return this._request("/back/admin/googleAuthCreate",{authCode:e})}certAuthCreate(e){return this._request("/back/admin/certAuthCreate",{authCode:e},"text")}passwordReset(e,t){return this._request("/back/admin/passwordReset",{authCode:e,newPassword:(0,r.YW)((0,r.YW)(t))})}myPermissions(){return this._request("/back/admin/myPermissions",{})}getAdminUrls(e=1,t=10,s=""){return this._request("/back/admin/urls",{page:e,limit:t,service:s})}addRole(e,t,s){return this._request("/back/admin/roleAdd",{roleName:e,urlPaths:t,leadRole:s})}editRole(e,t){return this._request("/back/admin/roleEdit",{roleName:e,urlPaths:t})}adminUsersList(e=1,t=10,s,_){const r={page:e,limit:t};return s&&(r["userRole"]=s),_&&(r["userStatus"]=_),this._request("/back/admin/users",r)}rolePermissions(e){return this._request("/back/admin/rolePermissions",{roleName:e})}addAdminUser(e,t,s){return this._request("/back/admin/userAdd",{userName:e,userRole:t,password:(0,r.YW)((0,r.YW)(s))})}userStatusSet(e,t=1){return this._request("/back/admin/userStatusSet",{userName:e,userStatus:t})}rolesAdminList(e=1,t=10,s,_){const r={page:e,limit:t};return s&&(r["leadRole"]=s),_&&(r["roleStatus"]=_),this._request("/back/admin/roles",r)}roleStatusSet(e,t=1){return this._request("/back/admin/roleStatusSet",{roleName:e,roleStatus:t})}adminServices(){return this._request("/back/admin/services",{})}downLoad(e,t){const s=document.createElement("a"),_=new Blob([e]);s.download=t,s.href=URL.createObjectURL(_),s.click()}async request(e,t){return this._request(e,t)}async _request(e,t,s="json"){const _=(0,n.A)();if(t&&(t["X-Request-ID"]=_),!r.PD.isRSA){const e=await this.createApiPublic();console.log(e),r.PD.updateRSA(e)}const o=this._isSecret?{data:r.PD.RSAPublicEncode(t)}:t;return i.service.post(this._host+e,o,{"api-version":"1.0.0","X-Request-ID":_,"content-type":"application/json",Authorization:r.PD.access,sign:r.PD.privateKey&&-1!=e.indexOf("/auth")?d(JSON.stringify(t)):r.PD.clientKey?a().HmacMD5(_,u(r.PD.clientKey)).toString():"","X-Request-SIGN":a().HmacMD5(JSON.stringify(t),_).toString()},{}).then((e=>{if("json"!=s)return e;if(200==e["code"])return e["data"];if(803==e["code"]||806==e["code"])return r.PD.clear(),void location.reload();throw{code:e["code"],data:e["data"],message:e["msg"]}}))}}const m=new l},4282:function(e,t,s){"use strict";s.r(t),s.d(t,{UsePermissionList:function(){return u.r},UserPermissionStore:function(){return u.e},clientApi:function(){return D},clientUser:function(){return g},debounce:function(){return f},enBack:function(){return p},routerData:function(){return b},showError:function(){return E.Q},showSuccess:function(){return E.T},thBack:function(){return P},zhBack:function(){return h}});var _=s(8979),r=s(1969);s.e(168).then(s.t.bind(s,5168,23));const i=[{path:"/",name:"parent",component:()=>s.e(168).then(s.t.bind(s,5168,23)),children:[]},{path:"/login",name:"login",component:()=>Promise.all([s.e(472),s.e(369)]).then(s.bind(s,7369))}],n=(0,_.createRouter)({history:(0,_.createWebHashHistory)(),routes:i});n.beforeEach(((e,t,s)=>{if("/login"==e.path)s();else{if(!r.PD.access)return void s("/login");s()}}));var o=n;const a={path:"permission",component:()=>s.e(675).then(s.t.bind(s,675,23)),meta:{title:"permission.title",icon:"house"},children:[{path:"url",component:()=>s.e(704).then(s.bind(s,2704)),meta:{title:"permission.url",icon:"house"}},{path:"role",component:()=>s.e(118).then(s.bind(s,3118)),meta:{title:"permission.role",icon:"house",auth:"角色清单查询"}},{path:"user",component:()=>s.e(310).then(s.bind(s,7310)),meta:{title:"permission.user",icon:"house",auth:"管理员用户查询"}},{path:"center",component:()=>Promise.all([s.e(472),s.e(356)]).then(s.bind(s,1356)),meta:{title:"permission.center",icon:"house"}}]};var c=s(6581),u=s(8869),d={submit:"确定",permission:{title:"权限管理",url:"权限列表",role:"角色列表",user:"管理员列表",center:"管理用户设置",secret:"加密文件",upload:"点击上传",login:"登录"}},l={permission:{title:"Authority Management",url:"Permission List",role:"Role List",user:"Administrator List"}},m={permission:{title:"การจัดการอำนาจ",url:"รายการสิทธิ์",role:"รายการบทบาท",user:"รายชื่อผู้ดูแลระบบ"}};const h=d,p=l,P=m;var E=s(3256);const b={router:o,adminAuth:a},D={accountApi:c.i},g=r.PD,f=(e,t)=>{let s;return function(){const _=self;s&&clearTimeout(s),s=setTimeout((()=>{e.apply(_,arguments)}),t)}},A=window.ResizeObserver;window.ResizeObserver=class extends A{constructor(e){e=f(e,20),super(e)}}},8869:function(e,t,s){"use strict";s.d(t,{e:function(){return a},r:function(){return c}});var _=s(6581),r=s(1969),i=s(8935),n=s(1095),o=s(5918);const a=(0,n.defineStore)("user-permission-store",(()=>{const e=(0,o.ref)([]),t=(0,o.ref)(""),s=(0,o.ref)(""),n=(0,o.computed)((()=>t=>"super"==r.PD.userRole||-1!=e.value.indexOf(t))),a=t=>{e.value=t},c=e=>{t.value=e},u=e=>{s.value=e},d=async()=>{try{const t=await _.i.myPermissions();null!=t&&(e.value=t.map((e=>e.urlName))),(0,i.$Emit)("reload-permission")}catch(t){console.log(t)}};return r.PD.access&&d(),{isPermission:n,urlName:e,loadMyPermission:d,roleName:t,setUrlName:a,setRoleName:c,setAuthorization:u,authorization:s}})),c=(0,n.defineStore)("user-permission-list",(()=>{const e=(0,o.ref)([]),t=(0,o.ref)([]),s=async()=>{try{const t=await _.i.getAdminUrls(1,1e3);console.log(t),e.value=t["records"]}catch(t){console.log(t)}},r=async()=>{try{const e=await _.i.rolesAdminList(1,1e3);console.log(e),t.value=e["records"]}catch(e){console.log(e)}};return s(),r(),{urlList:e,roleList:t,loadPermission:s,loadAdminList:r}}))},1969:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{PD:function(){return userInstance},XV:function(){return apiVersion},YW:function(){return md5string}});var _Users_mac_Desktop_git_adminback_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1114),core_js_modules_web_dom_exception_stack_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4979),core_js_modules_web_dom_exception_stack_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_web_dom_exception_stack_js__WEBPACK_IMPORTED_MODULE_0__),_api_account__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6581),admin_plugins__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8935),admin_plugins__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(admin_plugins__WEBPACK_IMPORTED_MODULE_2__),crypto_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3169),crypto_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(crypto_js__WEBPACK_IMPORTED_MODULE_3__),jsencrypt__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5422);const{encodeBase:encodeBase,decodeBase:decodeBase}=function(){const encodeCode="99,111,110,115,116,32,98,97,115,101,32,61,32,119,105,110,100,111,119,46,98,116,111,97,40,101,110,99,111,100,101,83,116,114,105,110,103,41,59,99,111,110,115,116,32,108,101,110,103,116,104,32,61,32,49,54,59,99,111,110,115,116,32,109,97,120,32,61,32,77,97,116,104,46,99,101,105,108,40,98,97,115,101,46,108,101,110,103,116,104,32,47,32,108,101,110,103,116,104,41,59,10,99,111,110,115,116,32,108,105,115,116,32,61,32,91,93,59,10,102,111,114,32,40,108,101,116,32,105,110,100,101,120,32,61,32,48,59,32,105,110,100,101,120,32,60,61,32,77,97,116,104,46,102,108,111,111,114,40,109,97,120,32,47,32,50,41,59,32,105,110,100,101,120,43,43,41,32,123,10,32,32,32,32,99,111,110,115,116,32,115,116,97,114,116,32,61,32,98,97,115,101,46,115,117,98,115,116,114,105,110,103,40,105,110,100,101,120,32,42,32,108,101,110,103,116,104,44,32,40,105,110,100,101,120,32,43,32,49,41,32,42,32,108,101,110,103,116,104,41,59,10,32,32,32,32,99,111,110,115,116,32,101,110,100,32,61,32,98,97,115,101,46,115,117,98,115,116,114,105,110,103,40,40,109,97,120,32,45,32,105,110,100,101,120,32,45,32,49,41,32,42,32,108,101,110,103,116,104,44,32,40,109,97,120,32,45,32,105,110,100,101,120,41,32,42,32,108,101,110,103,116,104,41,59,10,32,32,32,32,105,102,40,105,110,100,101,120,32,62,32,109,97,120,45,105,110,100,101,120,45,49,41,123,10,32,32,32,32,32,32,32,32,98,114,101,97,107,59,10,32,32,32,32,125,10,32,32,32,32,108,105,115,116,46,115,112,108,105,99,101,40,105,110,100,101,120,44,32,48,44,32,101,110,100,41,59,10,32,32,32,32,105,102,32,40,105,110,100,101,120,32,33,61,61,32,109,97,120,32,45,32,105,110,100,101,120,32,45,32,49,41,32,123,10,32,32,32,32,32,32,32,32,108,105,115,116,46,115,112,108,105,99,101,40,108,105,115,116,46,108,101,110,103,116,104,32,45,32,105,110,100,101,120,44,32,48,44,32,115,116,97,114,116,41,59,10,32,32,32,32,125,10,125,10,108,105,115,116,46,106,111,105,110,40,34,34,41,59",decodeCode="99,111,110,115,116,32,108,101,110,32,61,32,49,54,59,10,99,111,110,115,116,32,109,97,120,76,101,110,32,61,32,77,97,116,104,46,99,101,105,108,40,101,110,99,111,100,101,83,116,114,105,110,103,46,108,101,110,103,116,104,32,47,32,108,101,110,41,59,10,108,101,116,32,115,116,97,114,116,32,61,32,101,110,99,111,100,101,83,116,114,105,110,103,46,108,101,110,103,116,104,59,10,99,111,110,115,116,32,100,101,99,111,100,101,76,105,115,116,32,61,32,91,93,59,10,102,111,114,32,40,108,101,116,32,105,110,100,101,120,32,61,32,48,59,32,105,110,100,101,120,32,60,32,77,97,116,104,46,102,108,111,111,114,40,109,97,120,76,101,110,41,59,32,105,110,100,101,120,43,43,41,32,123,10,32,32,32,32,99,111,110,115,116,32,101,110,100,73,110,100,101,120,32,61,32,115,116,97,114,116,59,10,32,32,32,32,108,101,116,32,115,116,97,114,116,73,110,100,101,120,32,61,32,101,110,100,73,110,100,101,120,32,45,32,108,101,110,59,10,32,32,32,32,105,102,32,40,115,116,97,114,116,73,110,100,101,120,32,60,32,48,41,32,123,10,32,32,32,32,32,32,32,32,115,116,97,114,116,73,110,100,101,120,32,61,32,48,59,10,32,32,32,32,125,10,32,32,32,32,100,101,99,111,100,101,76,105,115,116,46,112,117,115,104,40,101,110,99,111,100,101,83,116,114,105,110,103,46,115,117,98,115,116,114,105,110,103,40,115,116,97,114,116,73,110,100,101,120,44,32,101,110,100,73,110,100,101,120,41,41,59,10,32,32,32,32,115,116,97,114,116,32,61,32,115,116,97,114,116,73,110,100,101,120,59,10,125,10,119,105,110,100,111,119,46,97,116,111,98,40,100,101,99,111,100,101,76,105,115,116,46,106,111,105,110,40,34,34,41,41",encodeFunc=eval('const list = encodeCode.split(",").map(Number);\n          String.fromCharCode(...list)'),decodeFun=eval('\n          const list = decodeCode.split(",").map(Number);\n          String.fromCharCode(...list)'),encodeBase=value=>{const encodeString=value;return eval(encodeFunc)},decodeBase=value=>{const encodeString=value;return eval(decodeFun)};return{encodeBase:encodeBase,decodeBase:decodeBase}}(),apiVersion="1.0.0",randomString=(e=32)=>{const t="abcdefghijklmnopqrstuvwxyz1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ";let s="";for(let _=0;_<e;_++){const e=Math.floor(Math.random()*t.length);s+=t.substr(e,1)}return s},md5string=e=>crypto_js__WEBPACK_IMPORTED_MODULE_3___default().MD5(e).toString();class PlayerInfo{constructor(){(0,_Users_mac_Desktop_git_adminback_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_5__.A)(this,"_encryptor",new jsencrypt__WEBPACK_IMPORTED_MODULE_4__.A),(0,_Users_mac_Desktop_git_adminback_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_5__.A)(this,"_clientKey",void 0),(0,_Users_mac_Desktop_git_adminback_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_5__.A)(this,"_access",void 0),(0,_Users_mac_Desktop_git_adminback_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_5__.A)(this,"_refresh",void 0),(0,_Users_mac_Desktop_git_adminback_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_5__.A)(this,"_publicKey",void 0),(0,_Users_mac_Desktop_git_adminback_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_5__.A)(this,"certAuth",void 0),(0,_Users_mac_Desktop_git_adminback_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_5__.A)(this,"createdTime",void 0),(0,_Users_mac_Desktop_git_adminback_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_5__.A)(this,"googleAuth",void 0),(0,_Users_mac_Desktop_git_adminback_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_5__.A)(this,"id",void 0),(0,_Users_mac_Desktop_git_adminback_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_5__.A)(this,"passwordPrimeval",void 0),(0,_Users_mac_Desktop_git_adminback_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_5__.A)(this,"status",void 0),(0,_Users_mac_Desktop_git_adminback_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_5__.A)(this,"userName",void 0),(0,_Users_mac_Desktop_git_adminback_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_5__.A)(this,"userRole",void 0),(0,_Users_mac_Desktop_git_adminback_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_5__.A)(this,"privateKey",void 0),(0,_Users_mac_Desktop_git_adminback_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_5__.A)(this,"_base","http://192.168.0.11"),(0,_Users_mac_Desktop_git_adminback_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_5__.A)(this,"_timer",void 0);const e=`_${apiVersion}_${this._base}`;this._publicKey=sessionStorage.getItem(e)||null,this.read()}getKey(){let e="";return e=this._clientKey?crypto_js__WEBPACK_IMPORTED_MODULE_3___default().enc.Hex.parse(this._clientKey).toString(crypto_js__WEBPACK_IMPORTED_MODULE_3___default().enc.Utf8):randomString(16),crypto_js__WEBPACK_IMPORTED_MODULE_3___default().enc.Utf8.parse(e)}getKeyToHex(){const e=this.getKey();return crypto_js__WEBPACK_IMPORTED_MODULE_3___default().enc.Hex.stringify(e)}decrypt(e){try{const t=crypto_js__WEBPACK_IMPORTED_MODULE_3___default().AES.decrypt(e,this.getKey(),{iv:this.getKey(),mode:crypto_js__WEBPACK_IMPORTED_MODULE_3___default().mode.CBC,padding:crypto_js__WEBPACK_IMPORTED_MODULE_3___default().pad.Pkcs7});return t.toString(crypto_js__WEBPACK_IMPORTED_MODULE_3___default().enc.Utf8).toString()}catch(t){return console.log(t),""}}set clientKey(e){this._clientKey=e}get clientKey(){return this._clientKey}get access(){return!!this._access&&this.decrypt(this._access)}get refresh(){return!!this._refresh&&this.decrypt(this._refresh)}addToken(e){this._access=e.access,this._refresh=e.refresh,this.certAuth=e.admin.certAuth,this.createdTime=e.admin.createdTime,this.googleAuth=e.admin.googleAuth,this.id=e.admin.id,this.passwordPrimeval=e.admin.passwordPrimeval,this.status=e.admin.status,this.userName=e.admin.userName,this.userRole=e.admin.userRole,this.saveJson(),this.addRefreshToken()}addRefreshToken(){this._timer&&(clearTimeout(this._timer),this._timer=null),this._timer=setTimeout((async()=>{try{const e=await _api_account__WEBPACK_IMPORTED_MODULE_1__.i.refreshToken(this.userName);this.addToken(e)}catch(e){}}),6e5)}saveJson(){const e={clientKey:encodeBase(this.clientKey),access:this._access,certAuth:this.certAuth,createdTime:this.createdTime,googleAuth:this.googleAuth,id:this.id,passwordPrimeval:this.passwordPrimeval,status:this.status,userName:this.userName,userRole:this.userRole,refresh:this._refresh};sessionStorage.setItem("_AUTH_ROID_",JSON.stringify(e))}clear(){sessionStorage.removeItem("_AUTH_ROID_");const e=`_${apiVersion}_${this._base}`;sessionStorage.removeItem(e),window.location.reload()}read(){const e=sessionStorage.getItem("_AUTH_ROID_"),t=JSON.parse(e??"{}");if(!t.clientKey)return;let s=decodeBase(t.clientKey);"undefined"===s&&(s=""),this.clientKey=s,this._access=t.access,this._refresh=t.refresh,this.certAuth=t.certAuth,this.createdTime=t._createdTime,this.googleAuth=t.googleAuth,this.id=t.id,this.passwordPrimeval=t.passwordPrimeval,this.status=t.status,this.userName=t.userName,this.userRole=t.userRole,this.addRefreshToken()}get isRSA(){return!!this._publicKey&&(this._encryptor.setPublicKey(this._publicKey),!0)}updateRSA(e){this._publicKey=e;const t=`_${apiVersion}_${this._base}`;sessionStorage.setItem(t,e),this.isRSA}RSAPublicEncode(e){try{let t=JSON.stringify(e),s=0,_=128,r=t.length,i="";while(s<r){let e="";e=r-s>=_?t.substr(s,_):t.substr(s);const n=this._encryptor.encrypt(e);i+=window.atob(n),s+=_}return window.btoa(i)}catch(t){return console.log(t.message),""}}}const userInstance=new PlayerInfo;(0,admin_plugins__WEBPACK_IMPORTED_MODULE_2__.$On)(admin_plugins__WEBPACK_IMPORTED_MODULE_2__.loginOutEvent,(()=>{userInstance.clear()}))},3256:function(e,t,s){"use strict";s.d(t,{Q:function(){return i},T:function(){return r}});var _=s(1219);const r=e=>{_.nk.success({message:e,zIndex:8e3,customClass:"tip-d"})},i=e=>{_.nk.error({message:e,zIndex:8e3,customClass:"tip-d"})}},477:function(){}}]);