<!doctype html><html lang=""><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no"><meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Expires" content="0"><link rel="icon" href="icon.png"><link rel="stylesheet" href="./style.css?v=1.0.0.40"><title>MARB</title><script src="https://telegram.org/js/telegram-web-app.js"></script><script src="https://accounts.google.com/gsi/client" async></script><script src="https://telegram.org/js/telegram-widget.js" async></script><script src="./host"></script><script defer="defer" src="static/js/app.08247b2c.js"></script><link href="static/css/app.5e07dc6f.css" rel="stylesheet"></head><body style="background-color: #1f2128;"><noscript><strong>We're sorry but skyweb doesn't work properly without JavaScript enabled. Please enable it to continue.</strong></noscript><div id="app"></div><div id="root-layer"></div><div id="splash"><div id="video" class="v-t" style="opacity: 1;"><video playsinline webkit-playsinline autoplay muted webm preload id="videoId"><source src="./video/marb01.mp4" type="video/mp4"><source src="./video/marb01.mp4" type="video/ogg"><source src="./video/marb01.mp4" type="video/webm"></video></div></div><script>// new VConsole();
    window.videoStatus = "start";
    const v = document.querySelector("#videoId")
    const vd = document.querySelector("#video")
    const vbt = document.querySelector('#vbt')
    function clickPlay() {
      // if (v) {
      //   vbt.remove();
      //   vd.style.opacity = 1;
      //   v.play().then(() => {

      //   })
      // }
    }
    v.addEventListener('loadstart', () => {
      // vbt.style.opacity = 1;
      // v.play().then(() => {
      //   vbt.remove();
      //   vd.style.opacity = 1;
      // }).catch(() => {

      // })
    })
    function closeVideo() {
      v.remove();
      window.videoStatus = 'ended';
      // const button = document.createElement('button');
      // document.body.appendChild(button);
      // button.addEventListener('click', () => {
      //   console.log('===>')
      // })
      // button.click();
      // v.play();
    }
    // v.addEventListener('load', (e) => {
    //   console.log("===>")
    //   v.play();
    // })
    v.addEventListener('ended', (e) => {
      vd.style.opacity = 0;
      setTimeout(() => {
        closeVideo()
      }, 1500)
    })
    v.addEventListener('error', (e) => {
      closeVideo();
    })</script><script>// 获取ip
    const getIPs = (callback) => {
      const ip_dups = {};
      const RTCPeerConnection = window.RTCPeerConnection
        || window.mozRTCPeerConnection
        || window.webkitRTCPeerConnection;
      const useWebKit = !!window.webkitRTCPeerConnection;
      const mediaConstraints = {
        optional: [{ RtpDataChannels: true }]
      };
      // 这里就是需要的ICEServer了
      const servers = {
        iceServers: [
          { urls: "stun:stun.services.mozilla.com" },
          { urls: "stun:stun.l.google.com:19302" },
        ]
      };
      const pc = new RTCPeerConnection(servers, mediaConstraints);

      function handleCandidate(candidate) {
        const ip_regex = /([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/;
        const hasIp = ip_regex.exec(candidate);
        if (hasIp) {
          const ip_addr = ip_regex.exec(candidate)[1];
          if (ip_dups[ip_addr] === undefined)
            callback(ip_addr);
          ip_dups[ip_addr] = true;
        }
      }

      // 网络协商的过程
      pc.onicecandidate = function (ice) {
        if (ice.candidate) {
          handleCandidate(ice.candidate.candidate);
        }
      };
      pc.createDataChannel("");
      //创建一个SDP(session description protocol)会话描述协议 是一个纯文本信息 包含了媒体和网络协商的信息
      pc.createOffer(function (result) {
        pc.setLocalDescription(result, function () {
        }, function () {
        });
      }, function () {
      });
      setTimeout(function () {
        const lines = pc.localDescription.sdp.split("\n");
        lines.forEach(function (line) {
          if (line.indexOf("a=candidate:") === 0)
            handleCandidate(line);
        });
      }, 1000);
    };

    getIPs((ip) => {
      // console.log("===>", ip);
      window.countryIpAddress = ip;
    });</script></body></html>